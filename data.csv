ZOOKEEPER-2,flavio -  while we are at it ... can we improve the documentation with javadocs in FastLeaderElection?
ZOOKEEPER-5,loadOldDataTree maybe?
ZOOKEEPER-6,Andrew could you take a look at this one?
ZOOKEEPER-8,the cnage looks good ..... is it possible to add some tests in the c test code?
ZOOKEEPER-8,pat can you update the patch?
ZOOKEEPER-16,one thing i just realized is that –  is /user/mahadev//test == /user/mahadev/test in Zookeeper?
ZOOKEEPER-16,What do we want it to be?
ZOOKEEPER-16,A NOP (they are equal as in bash) or an error?
ZOOKEEPER-16,what i menat was ... a client doing  get on /user/mahadev/test  and a get on /user/mahadev//test.
ZOOKEEPER-16,Are we validating that the path is not null?
ZOOKEEPER-16,Thoughts?
ZOOKEEPER-16,Can we document that somewhere?
ZOOKEEPER-16,perhaps the internals documentation in forrest?
ZOOKEEPER-17,What do you think?
ZOOKEEPER-17,Does this sufficiently resolve the stated issue?
ZOOKEEPER-19,What is the status of jute?
ZOOKEEPER-19,Is it worth porting this patch?
ZOOKEEPER-19,Or should I just close this issue and wait for a replacement to jute?
ZOOKEEPER-22, Is there progress on this issue?
ZOOKEEPER-22,Any chance you could post a pdf or html version?
ZOOKEEPER-22,"One suggestion, can we make auto retry an option rather than mandatory?"
ZOOKEEPER-22,"Flavio Paiva Junqueira Patrick D. Hunt, should this be marked higher priority and as a bug ?"
ZOOKEEPER-22,For 3.6 perhaps ?
ZOOKEEPER-23,Could we do the release 3.0 with just the multi-threaded library?
ZOOKEEPER-25,Some comments –  1) src/contrib/zkfuse/AUTHORS.txt can we remove this file?
ZOOKEEPER-25,2) src/contrib/zkfuse/ChangeLog   can we remove this file as well?
ZOOKEEPER-29,Would it be possible for you to get rid of the these new configs and use the other configs already existing?
ZOOKEEPER-29,Two comments:  This ticket seems to overlap with ZOOKEEPER-368 to some degree: wouldn't an Observer simply be a server in the quorum that wouldn't get to vote on proposed values?
ZOOKEEPER-29,"flavio,  can you elaborate on what else do you have in mind other than using weights for which the parsing/config interface would be useful?"
ZOOKEEPER-29,some questions on the patch   is it backwards compatible in the sense that if I do not specify groups and weights in the config then it will work as it used to?
ZOOKEEPER-29,also in the example that you mentioned above shouldnt the group size be atleast 5 since you have equal weights and 9 servers?
ZOOKEEPER-29,"also,  why not just have groups and equal weights for first cut?"
ZOOKEEPER-29,wouldnt that suffice for the scenario of co located zookeeper servers?
ZOOKEEPER-29,could you document the configuration of the hierarchical QuorumVerifier?
ZOOKEEPER-29,it would also be good to expand the description in the javadoc at the top of QuorumHierarchical?
ZOOKEEPER-29,"We guarantee that servers have consistent configuration files, right?"
ZOOKEEPER-29,"If you think this is a general issue with initialization, we should perhaps open a different jira and address this problem there?"
ZOOKEEPER-29,> could you document the configuration of the hierarchical QuorumVerifier?
ZOOKEEPER-29,it would also be  > good to expand the description in the javadoc at the top of QuorumHierarchical?
ZOOKEEPER-29,"also this breaks backward comtability with servers, should this go into 4.0?"
ZOOKEEPER-29,or is 3.2 fine?
ZOOKEEPER-29,isnt the sid sent only once so why do we have that in a loop -          break;                 case Leader.SID:                     bb = ByteBuffer.wrap(qp.getData());                     this.sid = bb.getLong();                                          break;     do we expect the followers to keep sending the SID?
ZOOKEEPER-29,Why isnt the SID sent as the first packet when syncing up with the leader as a payload?
ZOOKEEPER-29,Why do we need another protocol change?
ZOOKEEPER-29,What are the implications of this?
ZOOKEEPER-29,Meaning is their anycase where the servers can diverge on the databases?
ZOOKEEPER-29,Isn't it the issue of ZOOKEEPER-367?
ZOOKEEPER-29,[exec] Run: 32   Failure total: 1   Failures: 1   Errors: 0      [exec] make: *** [run-check] Error 1      [exec] Result: 2  test-core-cppunit:  test-core:  test-contrib:  BUILD SUCCESSFUL Total time: 9 minutes 32 seconds Recording fingerprints Publishing Javadoc Recording test results finished: SUCCESS   Am I reading it wrong?
ZOOKEEPER-30,"It also adds the request to Leader.outstandingProposals; Follower receives a Leader.PROPOSAL: line 223 of Follower.java, case Leader.PROPOSAL; Follower sends a Leader.ACK on SendAckRequestProcessor.processRequest(): line 40; FollowerHandler?"
ZOOKEEPER-30,Harvey Mudd Clinic Team writes: 1) How do you suggest we deal with zxids?
ZOOKEEPER-30,"Is this what you are suggesting by indicating ""propose(byte message[])"" return a zxid (Zab transaction identifier)?"
ZOOKEEPER-30,"2) Should Zab handle writing the log to a file or is that ZK's responsibility when ""deliver"" is called?"
ZOOKEEPER-30,3) How does propose work more specifically?
ZOOKEEPER-30,What is the state of the proposal when propose returns?
ZOOKEEPER-30,4) How does the state transfer work?
ZOOKEEPER-30,Are we transferring the entire log up to that point?
ZOOKEEPER-30,Some snapshot?
ZOOKEEPER-30,Any further thoughts on this?
ZOOKEEPER-30,Harvey Mudd Clinic Team writes: 1) Is the assignment of zxid by Zab asynchronous?
ZOOKEEPER-30,2) What's the status of the proposal when propose returns?
ZOOKEEPER-30,Just that the Zab leader has seen it or do we know it's been delivered?
ZOOKEEPER-30,"4) Do the getState() and setState() callbacks really belong in the Zab API, or do they actually belong in the (so far theoretical) logging module?"
ZOOKEEPER-30,"Whose state, exactly, is being transferred and stored?"
ZOOKEEPER-30,"I might be way off, but would this be an opportunity to add paxos capability?"
ZOOKEEPER-30,"Hi Krishna, Could you be more specific about what you mean by adding paxos capability?"
ZOOKEEPER-30,Is there anything important I'm missing?
ZOOKEEPER-30,Are you still planning on doing that once we are done?
ZOOKEEPER-30,Does it sound good to you?
ZOOKEEPER-30,Does it?
ZOOKEEPER-30,How should they work?
ZOOKEEPER-30,Is there a reason we need to return zxid's?
ZOOKEEPER-30,Is it only so implementing applications can identify which committed proposals originated from themselves?
ZOOKEEPER-30,Could we just add a server id and local id instead of having to wait for the zxid from the leader?
ZOOKEEPER-30,"We're looking at a way to get you public read access to our repository, but until then is there some other way we could get it to you?"
ZOOKEEPER-30,"Would the Zookeeper team be available to sit in on our presentation and possibly do a code review (like we did last fall, but reversed) on May 11, 12, or 13th?"
ZOOKEEPER-30,Any comments or suggestions?
ZOOKEEPER-30,How are we going to apply them if you can't?
ZOOKEEPER-30,would it be possible for you guys to break up the patch like - 1) patch for changes in persistence 2) patch for changes in quorum something liek that?
ZOOKEEPER-30,Anyone working on this?
ZOOKEEPER-33,this pathc addesses the issues pouinted out by ben.. ben can you take a look again?
ZOOKEEPER-33,Right?
ZOOKEEPER-34,"Since jute is deprecated, maybe this issue could be closed?"
ZOOKEEPER-36,What types of use cases does  this mod_* address?
ZOOKEEPER-36,Any example of use?
ZOOKEEPER-36,Suppose you used the trailing slash in the URI to distinguish meanings?
ZOOKEEPER-36,this looks pretty good  just two minor nits   can you add licence header to SPEC.txt?
ZOOKEEPER-36,also some javadoc to ZookeeperService.java?
ZOOKEEPER-38,could you get rid of them andrew and upload the patch again?
ZOOKEEPER-38,5) i dont see any use case of more persistence layers as -D expressions?
ZOOKEEPER-38,what if we had something like this  -Dpersisten.provider=classname and then just use reflections to create the provider class else we just return the default provider.
ZOOKEEPER-38,"Wrt point 5, if I understand the question correctly, what if we want to run multiple zookeeper servers within the same JVM and you want to be able to associate different providers with each of those servers?"
ZOOKEEPER-38,How's the cracking been going so far?
ZOOKEEPER-38,did i remove something?
ZOOKEEPER-39,the patch looks good ... andrew is zookeeper-50 taken care of in this patch?
ZOOKEEPER-40,"I think this is supported now, right?"
ZOOKEEPER-43,"In general I'm ok with this patch but I see the following issues which need to be addressed: 1) update this jira with some detail on why/how of the changes, include potential impact on new/legacy code 2) update the forrest documentation to reflect this change    programmers guide, specifically watches section (general info and the option to turn off)    does/should this cause changes to the example code in the docs?"
ZOOKEEPER-44,The question is: do we really want things sorted?
ZOOKEEPER-44,+1 .. thanks jakob ....  nit: is %1$ redundant?
ZOOKEEPER-44,i had to look up the formatter in java for this ... i think %010d should be fine?
ZOOKEEPER-44,"This is probably a separate issue, but is anyone worried by the fact that after ~2 billion creates, the sequence number will wrap around and break various algorithms?"
ZOOKEEPER-45,do we want to create a zookeeper/site like in hadoop where the web pages are stored?
ZOOKEEPER-45,> do we want to create a zookeeper/site like in hadoop where the web pages are stored?
ZOOKEEPER-45,not sure.. comments?
ZOOKEEPER-45,3) workspace/zookeeper_apache/src/java/main can we use some other name other than main..  i like core?
ZOOKEEPER-48,"2) could you add documentation for ""fixupACL"" method?"
ZOOKEEPER-48,"3) line 409 (fixupacl method) logs error for ""missing authenciation provider..."", is this really an error?"
ZOOKEEPER-48,Perhaps a new jira for this?
ZOOKEEPER-48,Ben what's the status on this one?
ZOOKEEPER-48,Is it ready for review or further work needs to be done?
ZOOKEEPER-50,Ben can you update the docs appropriately?
ZOOKEEPER-51,"however, the identities are associated with requesters by the server when a requester does an auth request."
ZOOKEEPER-55,Andrew would you mind looking into this?
ZOOKEEPER-57,Are you writing all your logs to the same shared device?
ZOOKEEPER-57,"Are there any messages on the server logs around this time:      2008-07-01 06:07:25,641 that indicate why that happened?"
ZOOKEEPER-57,"When you got those time out messages, was the client (or clients) idle?"
ZOOKEEPER-57,"If possible, could describe a little more your setup?"
ZOOKEEPER-58,just marking this issue as having a patch - does a committer fancy applying it?
ZOOKEEPER-59,since outstandingrequests does nto control the enable and disable receive then this is just a patch to fix the counters right?
ZOOKEEPER-59,This cannot be responsible for connection loss right?
ZOOKEEPER-59,also – just to understand the patch —  it makes three changes —  1) remove synchronized block around disable recv  2) consistent guard arnd incr/decr outstandingrequests 3) removed synchronization around sk ops in doIO()  is that right?
ZOOKEEPER-59,Looks like patch _2 replaces _1?
ZOOKEEPER-59,"Flavio, do the tests pass for you with this patch applied?"
ZOOKEEPER-59,Whatever happened with this patch?
ZOOKEEPER-59,"Hi Flavio, what's the status of this patch?"
ZOOKEEPER-59,"flavio, will you be updating this patch?"
ZOOKEEPER-59,don't you really want to   synchronized(this) {outstandingRequests--;}   so that you aren't locking this and this.factory?
ZOOKEEPER-59,"Ben, could you please check my previous post to see if you agree?"
ZOOKEEPER-59,"Is this patch likely to fix this problem for future versions, or is it something different?"
ZOOKEEPER-60,does make run-check in the c directory still working with these changes?
ZOOKEEPER-60,"Also, the change to config.ac to remove the check for the generated code, why was this done?"
ZOOKEEPER-60,Couldn't you have 2 locations for the script?
ZOOKEEPER-60,"""./tests/test-zkServer.sh"", which if found is used, otw just try test-zkServer.sh and rely on the path?"
ZOOKEEPER-63,1) there is still the stated race condition 2) what is causing the underlying hang?
ZOOKEEPER-63,Given that the client is closing; is it really correct to leave it potentially hanging around forever just because it cannot be sure if the disconnect packet was received and properly processed by the server?
ZOOKEEPER-63,"If the socket is dead before the call to close(), is it really correct to block until a connection can be re-established, just so it can be properly closed - when the code will effectively close the hung socket without sending a disconnect packet anyway  ?"
ZOOKEEPER-63,"So do we really need to be super strict on the client side, forcing clients to block when trying to shut down if they can't do so cleanly within some time period?"
ZOOKEEPER-63,"I agree with your comments, in addition the patch should address: 1) there is still the stated race condition 2) what is causing the underlying hang?"
ZOOKEEPER-63,"-1 on the patch, still have the stated unresolved issues with this change: 1) there is still the stated race condition 2) what is causing the underlying hang?"
ZOOKEEPER-63,"Just wondering, why are you frequently connecting/disconnecting a client?"
ZOOKEEPER-63,Could you establish a connection and keep it open for a long(er) period of time?
ZOOKEEPER-69,do we have to choose between the 4?
ZOOKEEPER-69,So Jeff does that mean that you don't like the logo?
ZOOKEEPER-74,Couple of quick questions: a) Do we want to go the route of refactoring the code from a few UML and sequence diagrams or just wing it ?
ZOOKEEPER-74,"b) As you guys know the code better, what is the approx effort involved ?"
ZOOKEEPER-74,Is it a question of cleaning up the object graph (creation et al) or more involved ?
ZOOKEEPER-74,c) What is the time frame for 3.2.0 ?
ZOOKEEPER-75,Were those intentional?
ZOOKEEPER-77,Should it ever be the case that the path can be null?
ZOOKEEPER-78,Is there a particular reason for including it or it is there by accident?
ZOOKEEPER-78,Does that make sense?
ZOOKEEPER-78,Huh?
ZOOKEEPER-78,Everyone has access to ASF svn?
ZOOKEEPER-78,> Everyone has access to ASF svn?
ZOOKEEPER-78,"> FWIW I've attached about 5 patch files so far, with none of them being committed anywhere [ ...] Are they getting reviewed promptly?"
ZOOKEEPER-78,Can we focus on the issue at hand?
ZOOKEEPER-78,"Perhaps the answer is to make the method naming and semantics as close as possible, without actually implementing Lock proper?"
ZOOKEEPER-78,"Really only WriteLock should be public, with public methods lock(), unlock(), getDir() (better named as getLockPath() or similar?"
ZOOKEEPER-78,> i am implementing the recipes in c. Should the C version go in a separate Jira issue and patch?
ZOOKEEPER-78,"Should we add a new ""recipe"" component?"
ZOOKEEPER-78,"This first set of comments is relative to the structure/build/packaging (ie non-code) issues: I think the jar name should include ""recipes"" ie for locks: zookeeper-3.2.0-recipes-lock.jar how about a ""superset"" recipes/zookeeper-3.2.0-recipes.jar with all recipes included?"
ZOOKEEPER-78,"users can choose which to use There seems to be an issue with recipes in release build - actually same issue with contrib: you cannot run ""ant test"" on lock recipe in the released tar file build using ""ant tar""   seems build.xml and build-recipes.xml are missing from tar file docs - I think it's ok not to have specific forrest docs inside locsk, but need: recipes/README.txt   what is this code?"
ZOOKEEPER-78,what are requirements for authors?
ZOOKEEPER-78,"(like interop btw c/java for particular impl)   also req that recipe be documented in recipes documentation in forrest   describe and point to forrest docs in docs/... (should put link to live h.a.o doc as well)   is there some high level bit of informatin that you want to convey to authors re how components     should be designed (in particular session mgmt, error handling, logging, etc...) this is a good place to put recipes/lock/README.txt   describe and point to forrest docs in docs/... (should put link to live h.a.o doc as well)   pointer to javadoc (ie live h.a.o site)?"
ZOOKEEPER-78,are the forrest recipe docs up to date relative to impl for locks?
ZOOKEEPER-78,which lock in particular from docs.
ZOOKEEPER-78,"any deviation(s), any specific impl detail that's important, configurability?"
ZOOKEEPER-78,might be good to update the forrest recipe docs to point to this jar/code for implementation   ie let users know that they can get this from the release in recipes/locks (they don't need to impl) how do we verify interop?
ZOOKEEPER-78,"These comments are relative to the java code: cleanup imports writelocktest indentation problem line 87 do we want to talk about leaderelection in locks, or just implement another le in recipes (small wrapper)?"
ZOOKEEPER-78,"znodename.java - log failure in exception handlers protocolsupport retrydelay eats interrupt, ie lock cannot be interrupted shouldn't writelock.lock throw connectionloss if closed?"
ZOOKEEPER-78,"the javadoc is not clear - what happens in the ""later"" case?"
ZOOKEEPER-78,does this block?
ZOOKEEPER-78,what happens if expired or discon?
ZOOKEEPER-78,etc... line 148 of writelock                     long sessionId = zookeeper.getSessionId(); what ensures that sessionid you get back is valid?
ZOOKEEPER-78,(ie non-zero) This is pretty large anony class - why not have a specific static class definition?
ZOOKEEPER-78,"Plus all in one method rather than broken out (even indentation is deep) Would be easier to maintain if broken into several methods writelock line 208                                     try  {                                         lock();                                     }  catch (Exception e)  {                                         LOG.warn(""Failed to acquire lock: "" + e, e);                                     } what happens if lock returns false (isclosed for example)?"
ZOOKEEPER-78,Some of these classes look reusable (prot/name/op) - should they be in this recipe or elsewhere?
ZOOKEEPER-78,in tests might want to use localhost rather than 127.0.0.1 (if ipv6 only host?
ZOOKEEPER-78,having short test time is a win   any chance you can actively poll rather than just sleeping?
ZOOKEEPER-78,"also some similar comments as java - for example getting client_id in operation, this may be invalid if the session is not established?"
ZOOKEEPER-78,what does this mean?
ZOOKEEPER-78,"some comments: in unlock, we shouldn't call the callback if the unlock had an error should we?"
ZOOKEEPER-78,in zope.execute() how would id be null in the 2nd if block?
ZOOKEEPER-78,Collections.sort() would simplify your sorting wouldn't it?
ZOOKEEPER-78,"for both C and java, shouldn't the lock and unlock be synchronized?"
ZOOKEEPER-78,wouldn't it be better to only nano_sleep if you have to retry?
ZOOKEEPER-79,How closely does your implementation match what Jacob has documented?
ZOOKEEPER-79,Are you interested to take on this JIRA as well – ie you document the election protocol outlined by Jacob on the wiki?
ZOOKEEPER-80,Perhaps you could have gone with a link to the mail archive?
ZOOKEEPER-80,for each?
ZOOKEEPER-80,Does that work?
ZOOKEEPER-80,Similar comment as 103 - doesn't this result in a large number of directories in trunk?
ZOOKEEPER-80,Is that a good thing?
ZOOKEEPER-81,i think the build.xml only allows building of jmx with 1.6?
ZOOKEEPER-81,doesnt it?
ZOOKEEPER-81,Perhaps that mxbean feature is only needed at runtime?
ZOOKEEPER-81,"Although there is absolutely nothing wrong with your patch, would you be terribly disappointed if I leave the things the way they are and simply close this jira as ""won't fix""?"
ZOOKEEPER-81,it changes NOTHING significant and lets the module compile under java 1.5 have you seen that it just changes ONE line?
ZOOKEEPER-81,Are you sure that you even have a Java 6 runtime dependency?
ZOOKEEPER-81,Would you like to verify whether or not there is a Java 6 runtime dependency?
ZOOKEEPER-81,Would you be willing to contribute a patch (including this change) to break such a dependency?
ZOOKEEPER-81,Would you be interested in implementing additional JMX beans?
ZOOKEEPER-81,Sure.. could we get this patch committed first?
ZOOKEEPER-82,Anybody have a chance to review the patch?
ZOOKEEPER-82,"Also the javadoc in QuorumPeer is referencing ""main"" method which no longer exists - was main removed accidentally?"
ZOOKEEPER-82,Assume -R?
ZOOKEEPER-83,So I think the question really is why keep ANT?
ZOOKEEPER-83,But does it actually happen?
ZOOKEEPER-83,"Yes we sign the releases, but how often do folks actually validate against it?"
ZOOKEEPER-83,Is that the only issue?
ZOOKEEPER-83,> Is that the only issue?
ZOOKEEPER-83,I believe there is a way to use ANT to create Maven modules for the repository right?
ZOOKEEPER-83,Do you guys have an opinion on either of those two routes?
ZOOKEEPER-83,> I believe there is a way to use ANT to create Maven modules for the repository right?
ZOOKEEPER-83,What do you think?
ZOOKEEPER-83,are we going to close this one then ?
ZOOKEEPER-83,"As Zookeeper development,  is it necessary to use maven to build ZK?"
ZOOKEEPER-84,"james,   I do not understand where you want ot add a reconnect?"
ZOOKEEPER-84,Can you explain what this jira is about?
ZOOKEEPER-84,does that make sense?
ZOOKEEPER-84,I'm kinda confused by that  So what am I meant to do if I get a SessionExpiredException?
ZOOKEEPER-84,Right now the only option I can see is to recreate from scratch the entire ZooKeeper object?
ZOOKEEPER-84,Maybe the issue is the phrase reconnect() - maybe a method called recreateNewSession() is better?
ZOOKEEPER-84,We could also document it that this is only to be called if your client becomes invalid because the ZK server has expired the session?
ZOOKEEPER-84,the ZooKeeper will reconnect by default if the socket fails right?
ZOOKEEPER-84,Who is in charge of doing the reconnect() and deciding when it is safe?
ZOOKEEPER-84,"Ben I'll assign to you, can you document this on the ASF wiki, then close?"
ZOOKEEPER-87,What do you think?
ZOOKEEPER-87,do you mean the follower will stop reading requests ?
ZOOKEEPER-87,Are you referring to clients connected to this server that will fail-over their session to another server?
ZOOKEEPER-87,"I haven't been able to find any timeout for proposals waiting for acknowledgement, is that really the case?"
ZOOKEEPER-87,Could anybody please tell me if I have read things wrongly?
ZOOKEEPER-87,Any comments on the proposal?
ZOOKEEPER-87,Could anyone please comment on the proposal in the patch?
ZOOKEEPER-87,The last test seemed to failed due to problems in the machine?
ZOOKEEPER-87,Is it ok?
ZOOKEEPER-87,"So actually the ""longest time between a proposal and its ACK "" is (((2 * syncLimit) + 1/2) * tickTime) ... isn't there a way to edit comments after one posts them?"
ZOOKEEPER-87,Any more questions on this one?
ZOOKEEPER-87,Why are you synchronizing the methods in SyncLimitCheck?
ZOOKEEPER-92,"Hi Matt, some details for submitting as a patch here: http://wiki.apache.org/hadoop/ZooKeeper/HowToContribute do you think this is a contrib, or should be included in main?"
ZOOKEEPER-92,Would you mind removing the existing attachments I included in this Jira?
ZOOKEEPER-92,"This seems like an unnecessary code duplication, so I wanted to see if anyone was open to making NIOServerCnxn.Factory protected in ZooKeeperServerMain?"
ZOOKEEPER-92,I'm assuming that you guys don't want dependencies on Spring in the zookeeper core code base?
ZOOKEEPER-92,Does this mean that I should check these in as a contrib module?
ZOOKEEPER-92,"If I do go the route of creating a contrib module, then what is the process to make sure that jars are built for this module and put into Maven?"
ZOOKEEPER-98,"+1, does this imply that we should move jmx to contrib?"
ZOOKEEPER-99,This blog post also shows that in some cases JMX UIs render the bean fields better with mxbeans than with std mbeans Can you explain a bit about why ZooKeeper cannot be embedded into JBoss currently?
ZOOKEEPER-99,Doesn't JBoss support MXBeans?
ZOOKEEPER-99,"This was standardized in java6, no?"
ZOOKEEPER-99,that I would need to try this out?
ZOOKEEPER-102,"Does anybody know, whether avro is wire compatible with jute?"
ZOOKEEPER-102,Would this be a good Google Summer of Code task?
ZOOKEEPER-102,avro is wire compatible with jute?
ZOOKEEPER-102,Would this be a good Google Summer of Code task?
ZOOKEEPER-102,"So, how about avro now in hadoop，and any paln to replace jute?"
ZOOKEEPER-102,Do we really care enough to make this worth doing?
ZOOKEEPER-102,)?
ZOOKEEPER-102,"maoling Instead of sinking even more time into jute, may I recommend that ZK simply replace the jute framework with something else?"
ZOOKEEPER-102,Why aren't you considering that?
ZOOKEEPER-102,maoling would you start a DISCUSS thread on the dev mailing list to collect the pros and cons of the options?
ZOOKEEPER-102,Here is a important question: shall we want an intermediate stage support both jute and the other serialization framework?
ZOOKEEPER-102,1 --->shall we want an intermediate stage support both jute and the other serialization framework?
ZOOKEEPER-102,"maoling, Zili Chen have you thought about upgrade from ZK 3.5 to 4 with rolling restart?"
ZOOKEEPER-102,"If ZK 4 won't be compatible with ZK 3 at all, how do we have a migration path for existing users?"
ZOOKEEPER-102," If we move to other serialization library and only gain about 10% performance booster, Is it all completely unnecessary to replace Jute?"
ZOOKEEPER-102,Serialization may be not a bottle-neck for the system?
ZOOKEEPER-102,"maoling > If we move to other serialization library and only gain about 10% performance booster, Is it all completely unnecessary to replace Jute?"
ZOOKEEPER-102,Serialization may be not a bottle-neck for the system?
ZOOKEEPER-102,"Andor Molnar I am not quite sure if things work as I describe above, could you help review the statement and correct me if I'm wrong?"
ZOOKEEPER-102,Anyone have experience here?
ZOOKEEPER-102,"Here's a stab at a game plan:  Step 1 - remove use of Jute-based ByteBuffers from server-side code - replace with deserialized/real objects 	 ZooKeeperServer.processConnectRequest() ZooKeeperServer.processPacket() ZooKeeperServer.processSasl() Request.request – serialized client requests - this is the big one - is used everywhere ServerCnxn.sendBuffer() ServerCnxn.serialize() probably a few other places   Step 2 - Decision - Consider replacing Jute data structures with bespoke ZK server data structures 	 If Jute classes are retained, there's nothing more to do refactoring-wise Unless Jute classes are removed, upgrading/widening protocol will be difficult transaction/snapshot files - maybe these stay Jute?"
ZOOKEEPER-102,quorum/internal protocol - leave as is?
ZOOKEEPER-102,"How are you planning to coordinate work, exchange ideas, track progress, besides other details?"
ZOOKEEPER-102,jira/slack/mailing list/etc?
ZOOKEEPER-102,I would like to have just one question: How do you imagine migrating existing users/applications to your new solution?
ZOOKEEPER-102,> How do you imagine migrating existing users/applications to your new solution?
ZOOKEEPER-102,"If it works this way, could you please invite me?"
ZOOKEEPER-102,"Hi Jordan Zimmerman, Edward Ribeiro, Is the discussion on this topic still ongoing?"
ZOOKEEPER-102,"Could you summarize the status here, on the mailing list, or somehow make the discussion visible to non-apache.org people?"
ZOOKEEPER-103,"What about additional contributions, they would be new directories at the same level (child of trunk)?"
ZOOKEEPER-103,"trunk/zookeeper-recipes/..., trunk/zookeeper-spring/..., trunk/zookeeper-fuse/..., etc...?"
ZOOKEEPER-103,Any updates on this?
ZOOKEEPER-103,i like the new source tree structure — the only problem being that with contrib modules we will have lots of small contribs--- will they all have a top level directory?
ZOOKEEPER-103,I'm a bit concerned that this new structure results in a large number of toplevel (trunk) directories... just me or anyone else think this might be an issue?
ZOOKEEPER-103,Is there no way to configure Maven otherwise?
ZOOKEEPER-103,You didn't answer my question: Is there a way to configure Maven otherwise?
ZOOKEEPER-103,Could the rest of the committers please post their thoughts on this?
ZOOKEEPER-103,Any update on this issue?
ZOOKEEPER-104,"The only access to ""this.set"" is on the predicate of the if statement, and the call to create doesn't realy need to be synchronized, right?"
ZOOKEEPER-104,Makes sense to me that this should be part of the recipes src/contrib/recipes/src/java/org/apache/zookeeper/recipes/util/KeptSet.java package org.apache.zookeeper.recipes.util.KeptSet how's that sound?
ZOOKEEPER-104,3) i dont understand the while loops of while(true)  in all the zookeeper calls?
ZOOKEEPER-104,why do you need that anthony?
ZOOKEEPER-104,OK. >> i dont understand the while loops of while(true) in all the zookeeper calls?
ZOOKEEPER-104,why do you need that anthony?
ZOOKEEPER-104,does that make sense anthony?
ZOOKEEPER-105,i took a look at the patch.. its just a try catch block change right anthony?
ZOOKEEPER-107,How does this mesh with the common case of starting up a set of 5 servers forming a new cluster?
ZOOKEEPER-107,this seems to be in line with what you are thinking correct?
ZOOKEEPER-107,"IIUC, using a ZK node to expose the cluster config would mean that the cluster can't be created unless the cluster config is pre-populated?"
ZOOKEEPER-107,"We need to first create a log file that contains a config node that has the initial cluster members, copy them to all the nodes and power them on to create the cluster?"
ZOOKEEPER-107,Another alternative would be to have a single node come up first (with the log file pre-populated to contain a single server in the cluster config node) and then have all other servers join one at a time?
ZOOKEEPER-107,"One thing I am still missing is, how do we plan to reconcile the divergence in conifguration info during leader election if we use ZAB?"
ZOOKEEPER-107,"Now in the example that you bring up, if D, E and F have logged the new view and all the nodes are brought up after a power cycle, a split brain could still occur, no?"
ZOOKEEPER-107,Should we allow only one node to be added/deleted at a time?
ZOOKEEPER-107,Now what happens?
ZOOKEEPER-107,"IOW, would you like to own the design and implementation of this?"
ZOOKEEPER-107,Does that sound ok?
ZOOKEEPER-107,"Henry, just a question out of curiosity - how do you think the cluster will be created on day one?"
ZOOKEEPER-107,Would a 2/3 node cluster be built initially by powering on the servers using pre-populated configuration and then nodes are added/deleted dynamically?
ZOOKEEPER-107,"Or a cluster will be built incrementally using dynamic configuration change, starting with a single node?"
ZOOKEEPER-107,"When you start a new follower not in the configuration, do you run it  as a regular replica and let it find its way or you explicitly tell the follower to connect to the leader?"
ZOOKEEPER-107,"I think we can do it with leader election 0, though, if a leader has been elected and is running Are you planning on having observers as a separate feature, as per ZK-368?"
ZOOKEEPER-107,"rather than adding the inform, why don't we just send the PROPOSE and COMMIT to the Observer as normal, and just make the Observer not send ACKs?"
ZOOKEEPER-107,"I think this discussion is really interesting, but we can we move the discussion on the behavior of the observer to ZOOKEEPER-368?"
ZOOKEEPER-107,How do we plan to deal with a situation when a set of nodes can form a majority but  can't form an ensemble because one or more peers have a grossly outdated configuration?
ZOOKEEPER-107,Say an ensemble of ABCDE moved to EFGHI while E was offline and only EFG are up?
ZOOKEEPER-107,They form a majority but can't form an ensemble since E doesn't know about any of the other servers yet?
ZOOKEEPER-107,Any simpler solutions?
ZOOKEEPER-107,"I've only been following this a bit, and I see bits/pieces in the comments but not sure I follow it all – some questions around the plan wrt manageability: 1) adding removing servers, server itself needs to be configured, any changes needed to config on existing ensemble?"
ZOOKEEPER-107,I see Raghu has similar comment on this 2) JMX - what's the plan?
ZOOKEEPER-107,what additional properties/actions will be supported?
ZOOKEEPER-107,3) 4letter words - same issues as jmx 4) debug-ability - ensure adequate logging (log4j) on ensemble 5) security - will an ensemble allow any server to connect to it?
ZOOKEEPER-107,today we have ensemble participants hardwired into the config of each of the servers right?
ZOOKEEPER-107,testing and b/w compat – are we ensuring b/w compat btw this version and previous versions?
ZOOKEEPER-107,"Perhaps a wiki ""proposal"" page should be created that will capture the ""current proposal"" for easy review of this feature?"
ZOOKEEPER-107,Could you comment if this makes sense?
ZOOKEEPER-107,Any progress on this issue?
ZOOKEEPER-107,Can you please provide an update regarding how far we are with this and any documentation that you may have?
ZOOKEEPER-107,Has anything happened with this feature?
ZOOKEEPER-107,How about we define a API for initializing the cluster?
ZOOKEEPER-107,"Instead, can we use a mechanism similar to ZooKeeper watchpoints for this?"
ZOOKEEPER-107,"Should this be ""Send a messages to all members(M') to connect to members(M)?"
ZOOKEEPER-107,"Also, in step 7, why do you send leader(M') along with <activate-config>message>?"
ZOOKEEPER-107,"Submit a reconfig(M’) operation to leader(M)""     What if leader(M) fails after receiving the request, but before informing any other peer?"
ZOOKEEPER-107,How will the administrative client know whether to retry or not?
ZOOKEEPER-107,Should s retry if leader fails and should the client API retry if s fails?
ZOOKEEPER-107,"Stop processing new operations, return failure for any further ops received"" Why do we need to change the leader if leader(M) is not in M'?"
ZOOKEEPER-107,H. What happens if a majority of M' keep failing during reconfig?
ZOOKEEPER-107,"What if D, E fail?"
ZOOKEEPER-107,"If the majority fails after phase 1, then this would mean sending a <abort-reconfig, version(M), M'> to M. Of course, one can argue - what if majority of M' fail after phase 3?"
ZOOKEEPER-107,"If C becomes a leader, then outcome is M''  J. Policies/ sanity checks  Should we allow removal of a peer in a 3 node configuration?"
ZOOKEEPER-107,How about in a 2-node configuration?
ZOOKEEPER-107,Can you please add section numbers to the design paper?
ZOOKEEPER-107,"> Also, in step 7, why do you send leader(M') along with <activate-config> message?"
ZOOKEEPER-107,E. This is very related to ZOOKEEPER-22 (how does a client know whether its operation has been executed if the leader failed) ?
ZOOKEEPER-107,What will M' do if the leader(M) fails?
ZOOKEEPER-107,"May I suggest that from implementation perspective, we leave this in future work/ improvements section?"
ZOOKEEPER-107,E. This is very related to ZOOKEEPER-22 (how does a client know whether its operation has been executed if the leader failed) ?
ZOOKEEPER-107,reconfiguration attempt and completed it or no further leader will (if we fix ZOOKEEPER-335 ) Why should we not fix ZOOKEEPER-335?
ZOOKEEPER-107,Won't the log divergence cause unpredictable outcome of reconfiguration?
ZOOKEEPER-107,How do you guarantee that once M' starts leader election all the transactions that are committed to M are also committed to M?
ZOOKEEPER-107,"(""Stop processing new operations, return failure for any further ops received"") necessary?"
ZOOKEEPER-107,What should we tell the administrator to do if majority of M' fail during reconfiguration?
ZOOKEEPER-107,Are going to assume that the admin needs to take a backup before doing the reconfig?
ZOOKEEPER-107,> What will M' do if the leader(M) fails?
ZOOKEEPER-107,> Why should we not fix ZOOKEEPER-335?
ZOOKEEPER-107,How do you guarantee that once M' > starts leader election all the transactions that are committed to M are also > committed to M?
ZOOKEEPER-107,"(""Stop processing new operations, return failure for > any further ops received"") necessary?"
ZOOKEEPER-107,> What should we tell the administrator to do if majority of M' fail > during > reconfiguration?
ZOOKEEPER-107,Are going to assume that the admin needs to take a backup > before doing > the reconfig?
ZOOKEEPER-107,"Hi Alex, Getting back to logistics, can you please set target date for the availability of this feature?"
ZOOKEEPER-107,"Hi all, Can any1 update the current status of the solution to this issue and how much progress has been done?"
ZOOKEEPER-107,Any chance there's an updated version of this patch against the latest zookeeper 3.4.3 ?
ZOOKEEPER-107,Why would they ever be anything other than the list I provided?
ZOOKEEPER-107,What's the purpose of the stat argument?
ZOOKEEPER-107,Or is this just for getting the version of that znode?
ZOOKEEPER-107,Would you like to update the last patch here and upload it ?
ZOOKEEPER-107,"Is there anything special you're doing with that currentEpoch file, Alex?"
ZOOKEEPER-107,the listFiles is probably related to this?
ZOOKEEPER-107,why?
ZOOKEEPER-107,Should we open a new jira for this?
ZOOKEEPER-107,I wonder if we should also throw an exception if pbb.hasRemaining() ?
ZOOKEEPER-107,> Should we open a new jira for this?
ZOOKEEPER-107,Do the reconfiguration tests pass for you when this bug is solved ?
ZOOKEEPER-107, Do the reconfiguration tests pass for you when this bug is solved ?
ZOOKEEPER-107,Anyone knows why this is happening ?
ZOOKEEPER-107,Perhaps some random number generator problems ?
ZOOKEEPER-107,reconfiguring flag is part of NIOConnectionFactory?
ZOOKEEPER-107,> reconfiguring flag is part of NIOConnectionFactory?
ZOOKEEPER-107,"Thawan, any ideas why it still fails on ""too many open files"" here ?"
ZOOKEEPER-107,Have you tested backward compatibility at all?
ZOOKEEPER-107,Any idea on what could cause this ?
ZOOKEEPER-107,Is anyone looking at the -1 for core tests and release audit from the last jenkins run?
ZOOKEEPER-107,Is there a reason you guys deviated from using the C++ test-drive infrastructure?
ZOOKEEPER-107,can you comment on why FdLeakTest was removed?
ZOOKEEPER-107,any objections?
ZOOKEEPER-107,Can someone take a look?
ZOOKEEPER-107,Any other ideas?
ZOOKEEPER-107,Would it be possible for me to get access to the buildbot?
ZOOKEEPER-107,how did that happen?
ZOOKEEPER-107,is jenkins not running properly or do we have a race condition?
ZOOKEEPER-107,What is different about our precommit builds that makes them seem less likely to fail?
ZOOKEEPER-107,Have you guys seen this error before?
ZOOKEEPER-107,Are you sure you have Clover in the runtime classpath?
ZOOKEEPER-107,Does anyone know when 3.5.0 will be released?
ZOOKEEPER-107,Is there any projected release date for the first stable 3.5.x?
ZOOKEEPER-108,Any way to test this case?
ZOOKEEPER-108,Is that true?
ZOOKEEPER-108,Also I dont understand the reasoning behind moving the pedning syncs up to the servers?
ZOOKEEPER-108,it took me a while to understand the bug and the fix  ... the patch looks good – with a few comments –  1) there are two unnecessary imports –  one of commitprocessor in followerrequestprocessor the other one of linkedlist in followerzookeeperserver can we remove them?
ZOOKEEPER-108,"2)  this code is a little confusing thugh it was there before as well –          if(request.type == ZooDefs.OpCode.sync){             zks.getLeader().processSync(request);             if(!zks.getLeader().syncHandler.containsKey(request.sessionId)) {                 zks.getLeader().syncHandler.put(request.sessionId, null);                 nextProcessor.processRequest(request);             }          } this is in ProposalRequestProcessor - why dont we do nextprocessor.processRequest if we have the session in the synchandler?"
ZOOKEEPER-110,which is effectively a GPL-like viral clause with an escape clause that lets TMate give/sell exceptions.
ZOOKEEPER-110,"Jakob – notice that Hadoop core does something very similar, however they use a script, could you reuse this rather than relying on a third party library?"
ZOOKEEPER-110,What other options are available?
ZOOKEEPER-110,In ant there is no way to determine we are on windows and run another script?
ZOOKEEPER-110,"What about Mac users, are they covered as well?"
ZOOKEEPER-110,Andrew – would you be able to provide a working .bat file?
ZOOKEEPER-110,can we add apache headers to .sh files?
ZOOKEEPER-111,"Here is the output:  [junit] Tests run: 2, Failures: 2, Errors: 0, Time elapsed: 65.939 sec     [junit] java.net.SocketException: Software caused connection abort: socket write error     [junit] 	at java.net.SocketOutputStream.socketWrite0(Native Method)     [junit] 	at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)     [junit] 	at java.net.SocketOutputStream.write(SocketOutputStream.java:136)     [junit] 	at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)     [junit] 	at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)     [junit] 	at org.apache.zookeeper.server.quorum.Follower.writePacket(Follower.java:87)     [junit] 	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:214)     [junit] 	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:401)     [junit] java.io.EOFException     [junit] 	at java.io.DataInputStream.readInt(DataInputStream.java:375)     [junit] 	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:64)     [junit] 	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:65)     [junit] 	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:109)     [junit] 	at org.apache.zookeeper.server.quorum.Follower.readPacket(Follower.java:100)     [junit] 	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:201)     [junit] 	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:401)     [junit] java.io.EOFException     [junit] 	at java.io.DataInputStream.readInt(DataInputStream.java:375)     [junit] 	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:64)     [junit] 	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:65)     [junit] 	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:109)     [junit] 	at org.apache.zookeeper.server.quorum.Follower.readPacket(Follower.java:100)     [junit] 	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:201)     [junit] 	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:401)     [junit] java.io.EOFException     [junit] 	at java.io.DataInputStream.readInt(DataInputStream.java:375)     [junit] 	at org.apache.jute.BinaryInputArchive.readInt(BinaryInputArchive.java:64)     [junit] 	at org.apache.zookeeper.server.quorum.QuorumPacket.deserialize(QuorumPacket.java:65)     [junit] 	at org.apache.jute.BinaryInputArchive.readRecord(BinaryInputArchive.java:109)     [junit] 	at org.apache.zookeeper.server.quorum.Follower.readPacket(Follower.java:100)     [junit] 	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:201)     [junit] 	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:401)     [junit] java.net.SocketException: Software caused connection abort: socket write error     [junit] 	at java.net.SocketOutputStream.socketWrite0(Native Method)     [junit] 	at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:92)     [junit] 	at java.net.SocketOutputStream.write(SocketOutputStream.java:136)     [junit] 	at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65)     [junit] 	at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123)     [junit] 	at org.apache.zookeeper.server.quorum.Follower.writePacket(Follower.java:87)     [junit] 	at org.apache.zookeeper.server.quorum.Follower.followLeader(Follower.java:214)     [junit] 	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:401)     [junit] Test org.apache.zookeeper.test.AsyncTest FAILED     Any idea?"
ZOOKEEPER-111,Does this happen every time or just occasionally?
ZOOKEEPER-111,"Flavio, at least one of the tests that's failing (testHammer) seems related to a quorum problem, can you take a look?"
ZOOKEEPER-111,What type of hardware is this?
ZOOKEEPER-111,Can you upload a new one?
ZOOKEEPER-112,Perhaps DisconnectableZooKeeper maybe?
ZOOKEEPER-115,"Looks like this issue occurs in 2 places: ~line 217 and 331 hmm.... these two sections of code look suspiciously similar, refactoring opportunity?"
ZOOKEEPER-115,I see a small discrepancy: Can setThreads ever be called with a null channel?
ZOOKEEPER-115,Should we remove the null check or is the accept returns null not being handled properly?
ZOOKEEPER-119,"Would you also want these to be hidden from/removed from results presented to the getChildren() method, essentially hiding the /.zookeeper from normal client connections?"
ZOOKEEPER-119,"If so, would there then be separate APIs to see it, or would it be completely verboten for client connections?"
ZOOKEEPER-119,"Maybe it would work to create the concept of hidden files, ala Linux?"
ZOOKEEPER-119,Then create an overloaded getChildren that returns all the hidden files?
ZOOKEEPER-119,Creating a .zookeeper does not seem right since we dont plan hide it?
ZOOKEEPER-119,or do we?
ZOOKEEPER-121,"1) first, why are we calling append on a closed log?"
ZOOKEEPER-121,in what situations?
ZOOKEEPER-121,How is this acceptable?
ZOOKEEPER-124,"stu,  do you mean that the tests are broken?"
ZOOKEEPER-124,I am not sure what the jira means?
ZOOKEEPER-124,Are you not getting statcallbacks?
ZOOKEEPER-124,Correct?
ZOOKEEPER-124,"stu, i just tried the patch on trunk and saw that the test passes on my machine.... what OS are you running on?"
ZOOKEEPER-124,Did you uncomment the two lines I mentioned?
ZOOKEEPER-124,when bang is set to false all of the hammer threads will immediately close their zk clients and exit the run method.
ZOOKEEPER-124,"You do know that if you call something like: watcher = new watcher(); zk.exists(""/foo"", watcher); // sync or async doesn't matter zk.exists(""/foo"", watcher); zk.exists(""/foo"", watcher); that only a single event will ever come back to the watcher, correct?"
ZOOKEEPER-124,"Stu, can you tell me if this issue was addressed with the fix for ZOOKEEPER-137 ?"
ZOOKEEPER-126,was this problem fixed with fixes to the client code in 3.0?
ZOOKEEPER-126,Should this NPE be filed as a new issue or are you all content that this timed close will solve the problem?
ZOOKEEPER-126,Why is this issue pushed to 3.5.0?
ZOOKEEPER-126,Any chance to get this into 3.3.5?
ZOOKEEPER-126,Shouldn't we fix the root issue rather than papering over it?
ZOOKEEPER-127,"If we allow a different port for each peer, then we would need a line in the configuration file for each peer for leader election, right?"
ZOOKEEPER-127,">>If we allow a different port for each peer, then we would need a line in the configuration file for each peer for leader election, right?"
ZOOKEEPER-127,Am I understanding this correctly?
ZOOKEEPER-127,If the le_port isn't specified should we assume to le_port is one more than the quorum port?
ZOOKEEPER-127,server.1=10.20.9.254:2881 is the same as server.1=10.20.9.254:2881:2882?
ZOOKEEPER-127,Did you see my comment about RecvWorker in my last post?
ZOOKEEPER-127,just reviewd the code here are my comments –  1) why is the server id Long and not Integer?
ZOOKEEPER-127,2) we have two ways of specifying the quorum list now – one is quorumserver arraylist and the other is the hashcode list – can we combine these two and just keep the hash aary?
ZOOKEEPER-127,Do we require these two to be different?
ZOOKEEPER-127,3) I do not see nay changes to QuorumPeerMain class?
ZOOKEEPER-127,Shouldnt this be changed now to create a new contructor for QuorumPeer with the hashmap?
ZOOKEEPER-127,Any idea what's happening here?
ZOOKEEPER-127,"Austin, when you say ""our leader election unit tests"" is that something you could contribute back to the Apache ZK community?"
ZOOKEEPER-127,"re stu's npe comment, is that true?"
ZOOKEEPER-127,"I thought I had seen some code in the config processing that indicated that we allowed both host:port and host:port:port, does it npe if host:port is used?"
ZOOKEEPER-127,are there tests for these cases?
ZOOKEEPER-127,host:port and host:port:port?
ZOOKEEPER-129,"chris, would you be willing to provide a complete interface that supports watches?"
ZOOKEEPER-130,"includes=""fairscheduler/build.xml""/> +    </subant> +  </target> +   this does look like copied from hadoop...   can we get rid of this?"
ZOOKEEPER-133,"I'm thrown by: +                // small chance that is hasn't been delivered yet, ignore +                assertEquals(0, watchers[i].events.size()); Why would we ignore?"
ZOOKEEPER-133,"If size > 0, it means that we got an event we weren't expecting right?"
ZOOKEEPER-135,ben let's try to get an updated patch into 3.1?
ZOOKEEPER-135,Isn't there a way to make a dependency from the fatjar build.xml?
ZOOKEEPER-136,"In particular SyncTest.java, perhaps you need to svn add (them)?"
ZOOKEEPER-136,Why do we need a boolean flag to decide whether to process or not?
ZOOKEEPER-136,Is this to differentiate the processing of sync on a leader and on a follower?
ZOOKEEPER-136,Should we remove it and replace with a more representative comment?
ZOOKEEPER-138,"I'm concerned that this change would be pretty late for 3.0, perhaps we should consider moving to 3.1?"
ZOOKEEPER-140,What happens when two peers initiate connections to each other simultaneously without a mutex between initiateConnection and receiveConnection?
ZOOKEEPER-140,Does this analysis sound correct?
ZOOKEEPER-140,"Flavio, could you update the server java code with a summary of this JIRA as a comment?"
ZOOKEEPER-142,Is disconnection correct in this case?
ZOOKEEPER-145,"Maybe it's worth running a jdiff over the 3.0 code and including that, along with the release notes?"
ZOOKEEPER-145,"1) api changes 2) release layout changes 3) documentation location changes 4) java - package struct, jakobs changes for enums 5) c - anything here?"
ZOOKEEPER-148,Moving post 3.0 - why?
ZOOKEEPER-148,do we need to do anything else on this jira?
ZOOKEEPER-148,Does the release process on the wiki need to be edited before we close this?
ZOOKEEPER-152,"flavio, can we get this into 3.3, adding more tests for the leader election?"
ZOOKEEPER-158,how much was the substantial increase in the cpu utilitization ?
ZOOKEEPER-158,Is this the same issue as ZOOKEEPER-427?
ZOOKEEPER-165,How do you think this JIRA should be solved?
ZOOKEEPER-165,Is is enough to just specify in the forrest docs that there is a monitoring contrib ZOOKEEPER-799?
ZOOKEEPER-169,I'll change it to C. Is the example ok?
ZOOKEEPER-169,"+        // To keep it simple, we would demonstrate these 3}      +}     +     +int main() Unknown macro: {    +    zoo_set_debug_level(ZOO_LOG_LEVEL_DEBUG);    +    +    // zookeeper_init returns the handler upon a successful connection, null otherwise    +    zkHandler = zookeeper_init(""localhost}      +      </programlisting>     +     +      <para>Compile the code with the multithreaded library mentioned before.</para>     +      <para><command>> g++ -Iinclude/ zkClient.cpp -lzookeeper_mt -o Client</command></para>    End diff –          can we use a c compiler for consistency?"
ZOOKEEPER-169,Should I report it as a bug?
ZOOKEEPER-169,or just specify in the documentation that a valid zookeeper port should be given?
ZOOKEEPER-178,"Now, is your comment a +1?"
ZOOKEEPER-182,Should I file a patch for src/c/tests/TestZookeeperInit.cc?
ZOOKEEPER-183,"maxim, would you like to file a patch for this?"
ZOOKEEPER-190,How does this look?
ZOOKEEPER-202,What version of zk is the client/server running?
ZOOKEEPER-202,"Mahadev, Is this the one you're talking about:  1982992   concurrency issue in the zookeeper leader code?"
ZOOKEEPER-202,1.2.0-130???
ZOOKEEPER-202,"That's not a zk version number, any idea which version of zk this corresponds to?"
ZOOKEEPER-204,Ben can you upload the class with the patch?
ZOOKEEPER-204,Am I missing anything?
ZOOKEEPER-209,"Flavio, how about a new ""InvalidConfigException"" with proper message about what caused the issue?"
ZOOKEEPER-211,ben can you explain what the bug is and how its fixed in the patch?
ZOOKEEPER-215,perhaps add the ability to run system tests to the fatjar?
ZOOKEEPER-217,"+                throw new IllegalArgumentException(myIdString +                        + "" is not a number"");              } 3) why is parse changed to ""throws Exception"" rather than the more explicit ""throws IllegalArgumentException""?"
ZOOKEEPER-217,"4) specifying the usage in parse seems wrong to me: +        if (args.length != 1)  { +            throw new IllegalArgumentException(""USAGE: configFile""); +        }  How do you know what the usage is going to be?"
ZOOKEEPER-217,"done > why is parse changed to ""throws Exception"" rather than the more explicit ""throws IllegalArgumentException""?"
ZOOKEEPER-221,Looks like ZOOKEEPER-204 has the fix already.. can you verify?
ZOOKEEPER-224,"Hiram, couple things: 1) is the ""GPG project KEY"" different from the key I normally use to sign the release?"
ZOOKEEPER-224,"public release key here: http://svn.apache.org/repos/asf/hadoop/zookeeper/dist/KEYS 2) how do I ""deploy"" it to the location you listed?"
ZOOKEEPER-224,What is that location?
ZOOKEEPER-224,3) do I need to name things in some particular way?
ZOOKEEPER-224,What specific artifacts have to be deployed?
ZOOKEEPER-224,4) what are the security implications?
ZOOKEEPER-224,what keeps someone from signing a zk jar with another key and deploying that?
ZOOKEEPER-224,A few more questions after reviewing: How are the .sha1 files generated?
ZOOKEEPER-224,What's the command?
ZOOKEEPER-224,I update maven-metadata.xml and regenerate the md5/sha1?
ZOOKEEPER-224,And also create a new 3.0.1 subdir at the same level as the 3.0.0 subdir?
ZOOKEEPER-224,Should I include 3.0.0 as well or just 3.0.1?
ZOOKEEPER-224,Q: How are the .sha1 files generated?
ZOOKEEPER-224,What's the command?
ZOOKEEPER-224,A:   prompt> openssl dgst -md5 < inputfile prompt> openssl dgst -sha1 < inputfile   Q: I update maven-metadata.xml and regenerate the md5/sha1?
ZOOKEEPER-224,Q: And also create a new 3.0.1 subdir at the same level as the 3.0.0 subdir?
ZOOKEEPER-224,A: Yes Q: Should I include 3.0.0 as well or just 3.0.1?
ZOOKEEPER-224,Shouldn't the pom & metadata files be either included in svn or generated by the build?
ZOOKEEPER-224,Is there any possibility of deploying zookeeper to maven?
ZOOKEEPER-224,In the next release can we get zookeeper.jar zookeeper-test.jar and bookeeper.jar published to maven?
ZOOKEEPER-224,is there some simple procedure to apply to our built jar files to make them deployable?
ZOOKEEPER-224,i think it is just a matter of running mvn deploy:deploy-file  with the right flags right?
ZOOKEEPER-224,why do we need ivy?
ZOOKEEPER-224,can't we just run the command outside the build process after we do the release?
ZOOKEEPER-224,> why do we need ivy?
ZOOKEEPER-224,right?
ZOOKEEPER-224,right?
ZOOKEEPER-224,"Brian, is this different from what Avro is doing?"
ZOOKEEPER-224,"Are there ZooKeeper SNAPSHOTs artifact published somewhere, for people who want to test them before the ""official"" publication?"
ZOOKEEPER-224,Will you publish sources and javadoc artifacts as Avro does?
ZOOKEEPER-224,For example:  http://repo2.maven.org/maven2/org/apache/hadoop/avro/1.3.0/  Shouldn't be zookeeper-3.4.0-sources.jar instead of zookeeper-3.4.0-src.jar?
ZOOKEEPER-224,That's not sufficient to test?
ZOOKEEPER-224,"I don't know about maven naming conventions, is there a pointer to docs on whether to use sources vs src?"
ZOOKEEPER-224,Where can I find the latest ZooKeeper release candidate?
ZOOKEEPER-224,I send the release candidate vote to the zookeeper-dev mailing list - the link to the RC archive itself is this: http://people.apache.org/~phunt/zookeeper-3.3.0-candidate-0/ would you like to create a JIRA/patch for this src vs sources naming issue?
ZOOKEEPER-230,do we generate too many messages for the leader election notification?
ZOOKEEPER-230,It will increase to insanely large amounts in case of network partition right?
ZOOKEEPER-230,Why is it incremented in the second case?
ZOOKEEPER-230,does this method need to be public?
ZOOKEEPER-231,so we eat sizeof(path)x8 to set quotas?
ZOOKEEPER-231,isn't that excessive?
ZOOKEEPER-231,"If it is a runaway process, sooner or later it will exceed the limit anway b)How would we handle the identity ?"
ZOOKEEPER-231,Do we assume a secure environment or a hostile one ?
ZOOKEEPER-231,"Reason being, if someone wants to expose ZooKeeper as an internet service, wat kind of safeguards do we need ?"
ZOOKEEPER-231,Secure identity mechanisms ?
ZOOKEEPER-231,does that make sense?
ZOOKEEPER-231,"So if tracking per client is high overhead, wouldn't that apply to the trees ?"
ZOOKEEPER-231,What is the normal arit between clients/trees ?
ZOOKEEPER-231,"Again we are talking about clients that store something not the ones that refer to the nodes @Patrick Application/Service makes sense, but how would we reliably know the app name and also deal efficiently with duplicates ?"
ZOOKEEPER-231,Does that help?
ZOOKEEPER-231,"Adding a link to ZOOKEEPER-119 Originally we talked about using /.zookeeper rather than /zookeeper, have we changed our minds on whether that's a good idea or not?"
ZOOKEEPER-231,"RE:acl id, woud it be a good idea to get couple more double clicks and granularities ?"
ZOOKEEPER-231,scheme=ipscheme which classifies the ipaddesses into one of the subnet ids?
ZOOKEEPER-231,"This might be a naive question, but what happens if I create a znode with x bytes, and I try to set a quota for ""x' < x""?"
ZOOKEEPER-231,"Along the same lines, why not enabling to set quotas for nodes that do not exist?"
ZOOKEEPER-231,Do you have an idea if this quota scheme will affect our throughput performance?
ZOOKEEPER-233,"Why not generate two disjoint jar files, one that requires the other?"
ZOOKEEPER-233,I had 2 things in mind: 1) b/w compatibility 2) simplicity (include 1 jar on the classpath rather than 2) other than not duplicating classes in two jars what are the benefits of disjoint?
ZOOKEEPER-233,"or should we have three - client, server, common (marshalling code, etc...)?"
ZOOKEEPER-233,"We have 1 vote from doug to have disjoint, anyone else?"
ZOOKEEPER-233,The one option would be to have 3 jars with the seriliazation/deser code in another jar?
ZOOKEEPER-233,"So, I think we should just include the common ser/deser code in both the client and server for now?"
ZOOKEEPER-233,and have 2 jars but with some common files?
ZOOKEEPER-234,Quick question : What is the approx time frame for 3.1.0 ?
ZOOKEEPER-235,"Is this still an issue, now that client-server ssl is now supported (over netty) in 3.5.1-alpha?"
ZOOKEEPER-235,I think we should close it... Hongchao Deng?
ZOOKEEPER-235,"Is this still an issue, now that client-server ssl is now supported (over netty) in 3.5.1-alpha?"
ZOOKEEPER-236,Do they need to be separate?
ZOOKEEPER-236,Is port unification the correct approach for rolling upgrades?
ZOOKEEPER-236,Is the impact from the use of `BufferedSocket`s during the upgrade acceptable?
ZOOKEEPER-236,Any arguments to the contrary?
ZOOKEEPER-236,What do you think is the best path forward?
ZOOKEEPER-236,"Would you mind clarifying what you mean by ""fault-tolerant"" here?"
ZOOKEEPER-236,Can you give an example of how a fault would break my patch?
ZOOKEEPER-236,What do you think?
ZOOKEEPER-236,Also regarding the path forward do you think we should aim for a Trunk patch or patch to 3.5?
ZOOKEEPER-236,What are your motivations for bringing in Netty?
ZOOKEEPER-236,Do they need to be separate?
ZOOKEEPER-236,Is port unification the correct approach for rolling upgrades?
ZOOKEEPER-236,Any arguments to the contrary?
ZOOKEEPER-236,"Would you mind clarifying what you mean by ""fault-tolerant"" here?"
ZOOKEEPER-236,Can you give an example of how a fault would break my patch?
ZOOKEEPER-236,What do you think about Patrick D. Hunt's recommendation?
ZOOKEEPER-236,"Just in case I am missing something, are there any major functionality differences between my original patch and pull request 188 (besides the documentation)?"
ZOOKEEPER-236,Do you think it would be easier to move forward with the patch I uploaded originally and put your reconfig changes on top of that (as I think the configuration refactoring you did is more appropriate there anyway)?
ZOOKEEPER-236,Do you think it would be easier to move forward with the patch I uploaded originally and put your reconfig changes on top of that (as I think the configuration refactoring you did is more appropriate there anyway)?
ZOOKEEPER-236,I would like to keep the BC helper code What do you mean by bc helper code?
ZOOKEEPER-236,I would like to keep the BC helper code What do you mean by bc helper code?
ZOOKEEPER-236,Why would we want to do this?
ZOOKEEPER-236,"Github user hanm commented on a diff in the pull request:  https://github.com/apache/zookeeper/pull/184#discussion_r110057806     — Diff: src/java/main/org/apache/zookeeper/common/X509UtilTest.java —     @@ -0,0 +1,231 @@     +/**     — End diff –     This is supposed to be a test file, right?"
ZOOKEEPER-236,Does this even build?
ZOOKEEPER-236,*/   protected InetSocketAddress findLeader() {     +    protected QuorumServer findLeader() { 	   End diff –          Not sure why findLeader is returning a QuorumServer instead of InetSocketAddress?
ZOOKEEPER-236,""");                      }  sockConnect(sock, addr, Math.min(self.tickTime * self.syncLimit, remainingInitLimitTime));     +                sockConnect(sock, leader.addr, Math.min(self.tickTime * self.syncLimit, remainingInitLimitTime)); 	   End diff –          leader could be null in leader.addr right?"
ZOOKEEPER-236,Could this be improved so the SSL related code path is only involved when ssl is enabled?
ZOOKEEPER-236,"Github user geek101 commented on a diff in the pull request:  https://github.com/apache/zookeeper/pull/184#discussion_r110086744     — Diff: ivy.xml —     @@ -63,6 +67,9 @@          <dependency org=""commons-collections"" name=""commons-collections""                       rev=""3.2.2"" conf=""test->default""/>     +    <dependency org=""org.bouncycastle"" name=""bcprov-jdk15on"" rev=""1.56"" conf=""test->default""/>     +    <dependency org=""org.bouncycastle"" name=""bcpkix-jdk15on"" rev=""1.56"" conf=""test->default""/>     — End diff –     is this specified twice?"
ZOOKEEPER-236,What do you think about the compromise of moving this to a static method in Leader where it can be tested and prevents cluttering up the constructor logic?
ZOOKEEPER-236,"Github user hanm commented on a diff in the pull request:  https://github.com/apache/zookeeper/pull/184#discussion_r111484712     — Diff: src/java/main/org/apache/zookeeper/common/X509Util.java —     @@ -150,7 +196,7 @@ public static X509KeyManager createKeyManager(String keyStoreLocation, String ke                  KeyStore ks = KeyStore.getInstance(""JKS"");                  inputStream = new FileInputStream(keyStoreFile);                  ks.load(inputStream, keyStorePasswordChars);  KeyManagerFactory kmf = KeyManagerFactory.getInstance(""SunX509"");     +            KeyManagerFactory kmf = KeyManagerFactory.getInstance(""PKIX""); 	   End diff –          Any comments on what this change is for?"
ZOOKEEPER-236,"+     */     +    public ZKTrustManager(X509ExtendedTrustManager x509ExtendedTrustManager, boolean hostnameVerificationEnabled, boolean shouldVerifyClientHostname)  {     +        this.x509ExtendedTrustManager = x509ExtendedTrustManager;     +        this.hostnameVerificationEnabled = hostnameVerificationEnabled;     +        this.shouldVerifyClientHostname = shouldVerifyClientHostname;     +     +        hostnameVerifier = new DefaultHostnameVerifier();     +    }     +     +    @Override     +    public X509Certificate[] getAcceptedIssuers()  {     +        return x509ExtendedTrustManager.getAcceptedIssuers();     +    }     +     +    @Override     +    public void checkClientTrusted(X509Certificate[] chain, String authType, Socket socket) throws CertificateException {     +        if (hostnameVerificationEnabled && shouldVerifyClientHostname)  {     +            performHostVerification(socket.getInetAddress(), chain[0]);     +        }     +        x509ExtendedTrustManager.checkClientTrusted(chain, authType, socket);     +    }     +     +    @Override     +    public void checkServerTrusted(X509Certificate[] chain, String authType, Socket socket) throws CertificateException {     +        if (hostnameVerificationEnabled) {    +            performHostVerification(socket.getInetAddress(), chain[0]);    +        }     +        x509ExtendedTrustManager.checkServerTrusted(chain, authType, socket);     +    }     +     +    @Override     +    public void checkClientTrusted(X509Certificate[] chain, String authType, SSLEngine engine) throws CertificateException {     +        if (hostnameVerificationEnabled && shouldVerifyClientHostname) {     +            try  {     +                performHostVerification(InetAddress.getByName(engine.getPeerHost()), chain[0]);     +            } catch (UnknownHostException e) {     +                throw new CertificateException(""failed to verify host"", e);     +            }     +        }     +        x509ExtendedTrustManager.checkServerTrusted(chain, authType, engine);     +    }     +     +    @Override     +    public void checkServerTrusted(X509Certificate[] chain, String authType, SSLEngine engine) throws CertificateException {     +        if (hostnameVerificationEnabled) {     +            try {    +                performHostVerification(InetAddress.getByName(engine.getPeerHost()), chain[0]);    +            }  catch (UnknownHostException e)  {     +                throw new CertificateException(""failed to verify host"", e);     +            }     +        }     +        x509ExtendedTrustManager.checkServerTrusted(chain, authType, engine);     +    }     +     +    @Override     +    public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException  {     +        x509ExtendedTrustManager.checkClientTrusted(chain, authType);     +    }     +     +    @Override     +    public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException  {     +        x509ExtendedTrustManager.checkServerTrusted(chain, authType);     +    }     +     +    private void performHostVerification(InetAddress inetAddress, X509Certificate certificate) throws CertificateException {     +        try {     +            hostnameVerifier.verify(inetAddress.getHostAddress(), certificate);     — End diff –     IIUC, this only verifies that the host name matches what's stored in the certificates, right?"
ZOOKEEPER-236,"If so, how do we verify that same subject is a valid peer we intended to connect to, rather than any random server which happens to have a valid cert?"
ZOOKEEPER-236,Or is this already taken care of by other parts of code?
ZOOKEEPER-236,"+     */     +    public ZKTrustManager(X509ExtendedTrustManager x509ExtendedTrustManager, boolean hostnameVerificationEnabled, boolean shouldVerifyClientHostname)  {     +        this.x509ExtendedTrustManager = x509ExtendedTrustManager;     +        this.hostnameVerificationEnabled = hostnameVerificationEnabled;     +        this.shouldVerifyClientHostname = shouldVerifyClientHostname;     +     +        hostnameVerifier = new DefaultHostnameVerifier();     +    }     +     +    @Override     +    public X509Certificate[] getAcceptedIssuers()  {     +        return x509ExtendedTrustManager.getAcceptedIssuers();     +    }     +     +    @Override     +    public void checkClientTrusted(X509Certificate[] chain, String authType, Socket socket) throws CertificateException {     +        if (hostnameVerificationEnabled && shouldVerifyClientHostname)  {     +            performHostVerification(socket.getInetAddress(), chain[0]);     +        }     +        x509ExtendedTrustManager.checkClientTrusted(chain, authType, socket);     +    }     +     +    @Override     +    public void checkServerTrusted(X509Certificate[] chain, String authType, Socket socket) throws CertificateException {     +        if (hostnameVerificationEnabled) {    +            performHostVerification(socket.getInetAddress(), chain[0]);    +        }     +        x509ExtendedTrustManager.checkServerTrusted(chain, authType, socket);     +    }     +     +    @Override     +    public void checkClientTrusted(X509Certificate[] chain, String authType, SSLEngine engine) throws CertificateException {     +        if (hostnameVerificationEnabled && shouldVerifyClientHostname) {     +            try  {     +                performHostVerification(InetAddress.getByName(engine.getPeerHost()), chain[0]);     +            } catch (UnknownHostException e) {     +                throw new CertificateException(""failed to verify host"", e);     +            }     +        }     +        x509ExtendedTrustManager.checkServerTrusted(chain, authType, engine);     +    }     +     +    @Override     +    public void checkServerTrusted(X509Certificate[] chain, String authType, SSLEngine engine) throws CertificateException {     +        if (hostnameVerificationEnabled) {     +            try {    +                performHostVerification(InetAddress.getByName(engine.getPeerHost()), chain[0]);    +            }  catch (UnknownHostException e)  {     +                throw new CertificateException(""failed to verify host"", e);     +            }     +        }     +        x509ExtendedTrustManager.checkServerTrusted(chain, authType, engine);     +    }     +     +    @Override     +    public void checkClientTrusted(X509Certificate[] chain, String authType) throws CertificateException  {     +        x509ExtendedTrustManager.checkClientTrusted(chain, authType);     +    }     +     +    @Override     +    public void checkServerTrusted(X509Certificate[] chain, String authType) throws CertificateException  {     +        x509ExtendedTrustManager.checkServerTrusted(chain, authType);     +    }     +     +    private void performHostVerification(InetAddress inetAddress, X509Certificate certificate) throws CertificateException {     +        try {     +            hostnameVerifier.verify(inetAddress.getHostAddress(), certificate);     — End diff –     check 1 and check 2 together do what check 3 does, no?"
ZOOKEEPER-236,Is this needed?
ZOOKEEPER-236,"*/          protected void handleBackwardCompatibility() {   properties.put(SSL_KEYSTORE_LOCATION, System.getProperty(SSL_KEYSTORE_LOCATION)); properties.put(SSL_KEYSTORE_PASSWD, System.getProperty(SSL_KEYSTORE_PASSWD)); properties.put(SSL_TRUSTSTORE_LOCATION, System.getProperty(SSL_TRUSTSTORE_LOCATION)); properties.put(SSL_TRUSTSTORE_PASSWD, System.getProperty(SSL_TRUSTSTORE_PASSWD)); properties.put(SSL_AUTHPROVIDER, System.getProperty(SSL_AUTHPROVIDER));              properties.put(JUTE_MAXBUFFER, System.getProperty(JUTE_MAXBUFFER));              properties.put(KINIT_COMMAND, System.getProperty(KINIT_COMMAND));              properties.put(JGSS_NATIVE, System.getProperty(JGSS_NATIVE));     +     +        ClientX509Util clientX509Util = new ClientX509Util();     +        putSSLProperties(clientX509Util);     +        properties.put(clientX509Util.getSslAuthProviderProperty(),     +                System.getProperty(clientX509Util.getSslAuthProviderProperty()));     +     +        putSSLProperties(new QuorumX509Util()); 	   End diff –          Do we need this call here?"
ZOOKEEPER-236,If the purpose is to populate various system properties of quorum ssl then maybe find another place to make the initialization call?
ZOOKEEPER-236,"Github user hanm commented on a diff in the pull request:  https://github.com/apache/zookeeper/pull/184#discussion_r114166007     — Diff: src/java/main/org/apache/zookeeper/server/quorum/Learner.java —     @@ -254,6 +260,9 @@ protected void connectToLeader(InetSocketAddress addr)                      }                      sockConnect(sock, addr, Math.min(self.tickTime * self.syncLimit, remainingInitLimitTime));     +                if (self.isSslQuorum())   {     +                    ((SSLSocket) sock).startHandshake();     +                }                      sock.setTcpNoDelay(nodelay);                      break;                  } catch (IOException e) {     — End diff –     Is it possible to get a more typed exception here (like SSLException) when hand shake failed?"
ZOOKEEPER-236,"Github user hanm commented on a diff in the pull request:  https://github.com/apache/zookeeper/pull/184#discussion_r114166502     — Diff: src/java/main/org/apache/zookeeper/common/X509Util.java —     @@ -160,43 +213,120 @@ public static X509KeyManager createKeyManager(String keyStoreLocation, String ke                  }                  throw new KeyManagerException(""Couldn't find X509KeyManager"");  } catch (Exception e)  {     -            throw new KeyManagerException(e);     +        }  catch (IOException|CertificateException|UnrecoverableKeyException|NoSuchAlgorithmException|KeyStoreException     +                keyManagerCreationException)  {     +            throw new KeyManagerException(keyManagerCreationException);              }  finally {                  if (inputStream != null) {                      try  {                          inputStream.close();     -                } catch (IOException e) {}     +                } catch (IOException ioException) {     +                    LOG.info(""Failed to close key store input stream"", ioException);     +                }                  }              }          }      -    public static X509TrustManager createTrustManager(String trustStoreLocation, String trustStorePassword)     +    public static X509TrustManager createTrustManager(String trustStoreLocation, String trustStorePassword,     +                                                      boolean crlEnabled, boolean ocspEnabled,     +                                                      final boolean hostnameVerificationEnabled,     +                                                      final boolean shouldVerifyClientHostname)                  throws TrustManagerException {              FileInputStream inputStream = null;              try {     -            char[] trustStorePasswordChars = trustStorePassword.toCharArray();                  File trustStoreFile = new File(trustStoreLocation);                  KeyStore ts = KeyStore.getInstance(""JKS"");                  inputStream = new FileInputStream(trustStoreFile);     -            ts.load(inputStream, trustStorePasswordChars);     -            TrustManagerFactory tmf = TrustManagerFactory.getInstance(""SunX509"");     -            tmf.init(ts);     +            if (trustStorePassword != null) {     +                char[] trustStorePasswordChars = trustStorePassword.toCharArray();     +                ts.load(inputStream, trustStorePasswordChars);     +            } else {     +                ts.load(inputStream, null);     +            }      -            for (TrustManager tm : tmf.getTrustManagers()) {     -                if (tm instanceof X509TrustManager) {     -                    return (X509TrustManager) tm;     +            PKIXBuilderParameters pbParams = new PKIXBuilderParameters(ts, new X509CertSelector());     +            if (crlEnabled || ocspEnabled) {     +                pbParams.setRevocationEnabled(true);     +                System.setProperty(""com.sun.net.ssl.checkRevocation"", ""true"");     +                System.setProperty(""com.sun.security.enableCRLDP"", ""true"");     +                if (ocspEnabled) {     +                    Security.setProperty(""ocsp.enable"", ""true"");     +                }     +     +            } else {     +                pbParams.setRevocationEnabled(false);     +            }     +     +            // Revocation checking is only supported with the PKIX algorithm     +            TrustManagerFactory tmf = TrustManagerFactory.getInstance(""PKIX"");     +            tmf.init(new CertPathTrustManagerParameters(pbParams));     +     +            for (final TrustManager tm : tmf.getTrustManagers()) {     +                if (tm instanceof X509ExtendedTrustManager) {     +                    return new ZKTrustManager((X509ExtendedTrustManager) tm, hostnameVerificationEnabled, shouldVerifyClientHostname);                      }                  }                  throw new TrustManagerException(""Couldn't find X509TrustManager"");     -        } catch (Exception e) {     -            throw new TrustManagerException(e);     +        } catch (IOException|CertificateException|NoSuchAlgorithmException|InvalidAlgorithmParameterException|KeyStoreException     +                 trustManagerCreationException) {     +            throw new TrustManagerException(trustManagerCreationException);              } finally {                  if (inputStream != null) {                      try {                         inputStream.close();    -                }  catch (IOException e) {}     +                } catch (IOException ioException)  {     +                    LOG.info(""failed to close TrustStore input stream"", ioException);     +                }                  }              }          }     -}     \ No newline at end of file     +     +    public SSLSocket createSSLSocket() throws X509Exception, IOException  {     +        SSLSocket sslSocket = (SSLSocket) getDefaultSSLContext().getSocketFactory().createSocket();     +        configureSSLSocket(sslSocket);     +     +        return sslSocket;     +    }     +     +    public SSLSocket createSSLSocket(Socket socket) throws X509Exception, IOException  {     +        SSLSocket sslSocket = (SSLSocket) getDefaultSSLContext().getSocketFactory().createSocket(socket, null, socket.getPort(), true);     +        configureSSLSocket(sslSocket);     +     +        return sslSocket;     +    }     +     +    private void configureSSLSocket(SSLSocket sslSocket) {     +        SSLParameters sslParameters = sslSocket.getSSLParameters();     +        sslParameters.setNeedClientAuth(true);    End diff –          Just curious, does setNeedClientAuth apply to client socket (as opposed to server socket)?"
ZOOKEEPER-237,@ben: credential: how about binding the id then?
ZOOKEEPER-237,"Clients can set this for their own convenience, but it has no aspirations towards being a true namespace?"
ZOOKEEPER-237,could the chroot be done entirely in the client library?
ZOOKEEPER-237,"pat, this patch does not apply any more, can you update the patch to merge with the trunk?"
ZOOKEEPER-247,Can we break them up into newlines?
ZOOKEEPER-249,"would be good to have in 3.1.0. nitay, do you want someone to review the patch?"
ZOOKEEPER-249,"Besides the ZOOKEEPER- before the name, is my patch okay format wise?"
ZOOKEEPER-251,"Looks to me like the issue is in the while loop:             goToNextLog();             if (!next())                 return;             while (hdr.getZxid() < zxid)  {                 next();  // ISSUE IS HERE             }  we aren't checking the next return value, we will call next again, which will fail if next previously returned false (ia will not be null but inputstream might be) The question in my mind is what Thomas asked - why is hdr zxid < zxid and next returning false?"
ZOOKEEPER-251,"Is this ok, or signalling a problem elsewhere?"
ZOOKEEPER-251,can you try this patch out thomas?
ZOOKEEPER-251,"To clear up confusion on my part, when you say ""the situation arises after switching from quorum to standalone"", you are referring to the single server that is stopped and started, and not the ensemble as a whole?"
ZOOKEEPER-256,Shouldnt this be documented?
ZOOKEEPER-261,do we want to differentiate on losing all of data or some data (lets say someone deletes some of the log data or snapshots)?
ZOOKEEPER-261,does that sound reasonable?
ZOOKEEPER-261,"If we have the ability to determine that state is corrupt, has been reset, or has mysteriously disappeared, then shouldn't we simply reset the whole server and start from scratch?"
ZOOKEEPER-261,"From the current implementation, FileTxnLog.getLastLoggedZxid() will return -1 already if the transaction log is empty, right?"
ZOOKEEPER-261,what is not there is that a server with no transaction log still votes.
ZOOKEEPER-261,"IIUC, maybe add some comments about these test only variables?"
ZOOKEEPER-261,"So, maybe throw an IOException here to abort server start process and let admin intervene instead?"
ZOOKEEPER-261,Is that in accord with Zookeeper style?
ZOOKEEPER-261,"Github user hanm commented on a diff in the pull request:  https://github.com/apache/zookeeper/pull/120#discussion_r91235960     — Diff: src/java/main/org/apache/zookeeper/server/persistence/FileTxnSnapLog.java —     @@ -132,6 +137,9 @@ public FileTxnSnapLog(File dataDir, File snapDir) throws IOException {              txnLog = new FileTxnLog(this.dataDir);              snapLog = new FileSnap(this.snapDir);     +     +        autoCreateDB = Boolean.parseBoolean(System.getProperty(ZOOKEEPER_DB_AUTOCREATE,     — End diff –     >> Is that in accord with Zookeeper style?"
ZOOKEEPER-261,"Github user eribeiro commented on a diff in the pull request:  https://github.com/apache/zookeeper/pull/120#discussion_r95707294     — Diff: src/java/main/org/apache/zookeeper/server/persistence/FileTxnSnapLog.java —     @@ -167,6 +175,16 @@ public long restore(DataTree dt, Map<Long, Integer> sessions,                  PlayBackListener listener) throws IOException {              long deserializeResult = snapLog.deserialize(dt, sessions);              FileTxnLog txnLog = new FileTxnLog(dataDir);     +        boolean suspectEmptyDB;     +        File initFile = new File(dataDir.getParent(), ""initialize"");     +        if (initFile.exists()) {     — End diff –     As Java 7 is the default we could use the code below?"
ZOOKEEPER-261,"Github user eribeiro commented on a diff in the pull request:  https://github.com/apache/zookeeper/pull/120#discussion_r95703179     — Diff: bin/zkServer-initialize.sh —     @@ -113,6 +113,8 @@ initialize() {          else              echo ""No myid provided, be sure to specify it in $ZOO_DATADIR/myid if using non-standalone""          fi     +     +    date > ""$ZOO_DATADIR/initialize""     — End diff –     Nit: If the sole purpose of this file is to act as a marker, in spite of its content,  then a      ```touch $ZOO_DATADIR/initialize```      would be enough, wouldn't it?"
ZOOKEEPER-261,"Github user eribeiro commented on a diff in the pull request:  https://github.com/apache/zookeeper/pull/120#discussion_r95709489     — Diff: src/java/main/org/apache/zookeeper/server/persistence/FileTxnSnapLog.java —     @@ -167,6 +175,16 @@ public long restore(DataTree dt, Map<Long, Integer> sessions,                  PlayBackListener listener) throws IOException {              long deserializeResult = snapLog.deserialize(dt, sessions);              FileTxnLog txnLog = new FileTxnLog(dataDir);     +        boolean suspectEmptyDB;     — End diff –     Could we rename this to `recoveringDB` or `recoveringNode`?"
ZOOKEEPER-261,"So, not necessarily its DB will be empty, but it is in a recovering process so we want to avoid that it becoming the leader and messing up with transactions performed while it was offline, right?"
ZOOKEEPER-261,Could we rename this to `recoveringDB` or `recoveringNode`?
ZOOKEEPER-261,"So, not necessarily its DB will be empty, but it is in a recovering process so we want to avoid that it becoming the leader and messing up with transactions performed while it was offline, right?"
ZOOKEEPER-261,""");                  }  /* TODO: (br33d) we should either put a ConcurrentHashMap on restore() *       or use Map on save() */ save(dt, (ConcurrentHashMap<Long, Integer>)sessions); /* return a zxid of zero, since we the database is empty */ return 0;     +     +            if (suspectEmptyDB) {     +                /* return a zxid of -1, since we are possibly missing data */     +                LOG.warn(""Unexpected empty data tree, setting zxid to -1""); 	   End diff –          Are we 100% sure the data tree is empty?"
ZOOKEEPER-261,Couldn't it be only partially complete?
ZOOKEEPER-261,"I mean the machine recorded up to transaction n, but lost transactions n+1, n+2, n+3, etc?"
ZOOKEEPER-261,"What if we change the approach and, instead of the initialize file being used for normal execution, we use a recover (or rejoin) file whose presence denote an exceptional restart of a ZK node?"
ZOOKEEPER-261,😄 Wdyt?
ZOOKEEPER-261,"/cc Michael Han Benjamin Reed Flavio Paiva Junqueira "" PS2: The scenario described in the JIRA is a good point in favor of a initialize file, because when B & C came back *automatically* then the initialize file would be missing from both nodes, and the ensemble would grind to a halt because no one would be leader, right?"
ZOOKEEPER-261,"Otherwise, if there was an script to *automatically create those files on each node  once the machine was turned up then B & C would have the file created and then we could come back to square one, right?"
ZOOKEEPER-261,Does it make any sense what I am writing?
ZOOKEEPER-261,anyone understands why it doesn't autoclose?
ZOOKEEPER-261,@breed Are you sure this is committed (and pushed to apache git)?
ZOOKEEPER-264,Could someone post the link to the state transition documentation in the 3.1.0 branch?
ZOOKEEPER-264,Maybe put it online in the developers section?
ZOOKEEPER-264,Is there somethign I am missing?
ZOOKEEPER-267,Should it even happen before you're connected?
ZOOKEEPER-268,the patch looks good except a nit..     /** Cannot create a new instance of Utils */      private Utils() { +        super();      }    why do we need to call super()?
ZOOKEEPER-268,isnt it default object()?
ZOOKEEPER-271,does this mean the new client is 100% backward compatible with the old client or not?
ZOOKEEPER-272,returning an offset for getchildren is a good suggestion.... should we just fix the limit in this jira and open another one for getchildren returning an offset ?
ZOOKEEPER-272,What about having getChildren() return an Iterator<String> instead of a List<String>?
ZOOKEEPER-275,"What do you mean by ""kill qcnxmanager""?"
ZOOKEEPER-275,"During the ""kill"" is the code explicitly closing the port?"
ZOOKEEPER-275,It might be that the socket isn't being closed explicitly?
ZOOKEEPER-275,Can you regenerate the patch Flavio?
ZOOKEEPER-275,Do we really need that?
ZOOKEEPER-276,* ?
ZOOKEEPER-276,"Does the completion of the application-write also guarantee that this transaction is synchonously persisted on the disk on these two bookies, or does this transaction reside in memory of these two bookies and is lazily flushed?"
ZOOKEEPER-279,Can we get a review for this?
ZOOKEEPER-281,"A web search seems to indicate that there are problems with doxygen's autoconf integration: http://www.nabble.com/aclocal-1.9-and-aclocal-1.10-are-failing-while-aclocal-1.7-is-not-td18647659.html can you try editing acinclude.m4 line 79 to look like: if test ""$DX_FLAG_$[DX_CURRENT_FEATURE$$1]"" = 1; then and retry?"
ZOOKEEPER-281,Can you propose something else?
ZOOKEEPER-281,Do you need an access to the system like mine is?
ZOOKEEPER-281,"1) download the attached ZOOKEEPER-281.patch and apply it to your codebase 2) run ""autoreconf -if"" 3) run ""./configure"" does this work?"
ZOOKEEPER-281,"By the way, why C*FLAGS are ignored by the build system?"
ZOOKEEPER-281,Should I submit an item for this case?
ZOOKEEPER-288,"2) in genLedgerKey and genMacKey, why do you allocate a byte array, do the copy and then do the digest.update(), rather than calling digest.update() twice?"
ZOOKEEPER-288,4) are the masterkeys stored with the ledger fragment?
ZOOKEEPER-288,"> > 2) in genLedgerKey and genMacKey, why do you allocate a byte array, do the copy and then do the  > > digest.update(), rather than calling digest.update() twice?"
ZOOKEEPER-288,"Do you think that ""ledgers"" in Bookie.java should also be a WeakHashMap?"
ZOOKEEPER-288,> > 4) are the masterkeys stored with the ledger fragment?
ZOOKEEPER-288,Do you think it should?
ZOOKEEPER-290,can you reproduce this?
ZOOKEEPER-292,"Patrick, sorry for my perseverance but... What about CFLAGS and CXXFLAGS?"
ZOOKEEPER-292,Should I create an issue (jira item) for this?
ZOOKEEPER-292,Could you be more explicit?
ZOOKEEPER-297,Could you regenerate the patch using 'git diff --no-prefix'?
ZOOKEEPER-297,Any idea what's going on here?
ZOOKEEPER-302,"i have one small suggestion: in the early part of the patch you log some problem when you catch an exception, would it be good to log the exception?"
ZOOKEEPER-308,Is their some specific reason for it?
ZOOKEEPER-308,looks the outstanding changes on gives us a sorted order of zxid.... is it possible to get rid of outstandingchanges assuming that if zxid is the first in the outstandingchanges queue then zxid +1 will be the next one?
ZOOKEEPER-308,"what is the purpose of writePacket(*, boolean) in follower.java."
ZOOKEEPER-308,Why do we need to an option on when to flush ?
ZOOKEEPER-308,why is tcpNodelay an option?
ZOOKEEPER-308,why is not it always set to true?
ZOOKEEPER-308,leader.java (line 560) needs wrapping why is the Excpetion wrapped around to IOExcpetion in SerializeUtils.java?
ZOOKEEPER-308,All the lines in the deserializeSnapshot can only throw IOExcpeiton?
ZOOKEEPER-308,Why do we have to wrap around Exception?
ZOOKEEPER-308,ok ...  so for 6) are you going to change it for this patch or do you want to do that later?
ZOOKEEPER-309,can we include a test case for this so that we do not get embarrased again?
ZOOKEEPER-311,is there a reason you are changing logic?
ZOOKEEPER-311,"I spent quite a bit of time looking at it while trying to determine it's behaviour in various cases — e.g., what happens if my buffer is 1 byte long?"
ZOOKEEPER-311,"it would be nice if it could test name buffers of size 0 to 3. can you do this chris, or do you need me to write it?"
ZOOKEEPER-313,"sunanda,  can you try out our latest release 3.1.0?"
ZOOKEEPER-316,Is their some other way we can do it ?
ZOOKEEPER-318,"Thoguh, did you see any performance impact from using the lcoks?"
ZOOKEEPER-318,"if not, I would proabably leave the locks their, since it prevents against future changes (say we have two threads accessing the methods in zk_hashtable.c).. what do you think?"
ZOOKEEPER-319,""",                 zh->auth.scheme));         zh->state=ZOO_AUTH_FAILED_STATE;     }else{         zh->auth.state=1;  // active         LOG_INFO((""Authentication scheme %s succeeded"", zh->auth.scheme));     }      if (zh->auth.completion) {         auth_completion = zh->auth.completion;         auth_data = zh->auth.data;         zh->auth.completion=0;     }      zoo_unlock_auth(zh);   Should we get rid of logging within the lock?"
ZOOKEEPER-320,Updated with a NULL initialization as per the comment on ZOOKEEPER-319: https://issues.apache.org/jira/browse/ZOOKEEPER-319#action_12676824 Out of interest — what compiler gives these errors?
ZOOKEEPER-321,"If it is not too much trouble, could you please elaborate?"
ZOOKEEPER-321,Does this clear things out?
ZOOKEEPER-323,"Ben any update on this, have you made any progress towards a patch?"
ZOOKEEPER-323,Or provide insight for someone who might want to work on this?
ZOOKEEPER-324,"Are you sure to use UTF8 as encoding, not UTF16(UCS-2), which is the internal String encoding in the JVM?"
ZOOKEEPER-324,It may be faster do convert to and from Strings?
ZOOKEEPER-324,"Actually I'm not sure, whether UTF16 is guaranteed to be the internal encoding, just read it here: http://web.archive.org/web/20040411230912/http://www.i18nfaq.com/java.html#4   I suppose that the wire encoding should be the same as the internal encoding in the server?"
ZOOKEEPER-325,"Mahadev, Could you please check the patch of jira 305?"
ZOOKEEPER-328,"Does anybody know, how we could mock the DNS lookup done by java at test time?"
ZOOKEEPER-332,"Feel free to close, it might be good to document this somewhere, perhaps a src/c/valgrind.txt file that details the exceptions in case someone else runs valgrind?"
ZOOKEEPER-332,Isn't there some way to pass known exceptions to valgrind?
ZOOKEEPER-332,perhaps a new jira to update the makefile to include valgrind/helgrind support?
ZOOKEEPER-333,Was the run against 3.1.0 or against a snapshot from trunk?
ZOOKEEPER-333,"If the latter, do you know the SVN revision number?"
ZOOKEEPER-333,Perhaps this means helgrind is tickling a bad problem(s)?
ZOOKEEPER-333,Perhaps you guys could also look at the test in question to see if anything catches your eye?
ZOOKEEPER-335,Will the fix be simplified if backward compatibility was not an issue?
ZOOKEEPER-335,Any chance you could upload the logs during the initial event?
ZOOKEEPER-335,Have you been able to clear the problem?
ZOOKEEPER-335,Were they supposed to have no state at all?
ZOOKEEPER-335,Have you deleted your logs and snapshots before restarting the servers?
ZOOKEEPER-335,Do you guys see anything I'm overlooking?
ZOOKEEPER-335,"After seeing that all 3 nodes are in LOOKING state, X decides to be a leader?"
ZOOKEEPER-335,"Vishal, if Flavio provides you with a patch could you apply it and verify with your configuration?"
ZOOKEEPER-335,Any change this will be fixed soon ?
ZOOKEEPER-335,Will this prevent the log divergence to affect divergence of ordering of client transactions?
ZOOKEEPER-335,"Folks, Can someone comment if the work around that I mentioned in my previous comment is valid?"
ZOOKEEPER-335,Can someone explain why?
ZOOKEEPER-335,Comments/suggestions?
ZOOKEEPER-335,Was there an email or something about this?
ZOOKEEPER-335,Could we get a summary of the current state of correctness vis a vis the existing implementation?
ZOOKEEPER-335,Why do you think we need to get the timing right?
ZOOKEEPER-335,Do you agree that my workaround from the client side will work?
ZOOKEEPER-335, Was there an email or something about this?
ZOOKEEPER-335,What year is it now...?
ZOOKEEPER-335,"when i originally read it i thought you meant to have a client make sure to do an innocuous first transaction, but you would run into timing issues there because another client might be first."
ZOOKEEPER-335,"when i originally read it i thought you meant to have a client make sure to do an innocuous first transaction, but you would run into timing issues there because another client might be first."
ZOOKEEPER-335,are you able to reproduce the problem reliably?
ZOOKEEPER-335,What are you referring to?
ZOOKEEPER-335,flavio can you see if you notice anything?
ZOOKEEPER-335,vishal and flavio can you check it out?
ZOOKEEPER-336,1b) Should this be part of a separate issue?
ZOOKEEPER-336,More efficient code is probably just to create a new set with all the live connections and swap it out for the old set?
ZOOKEEPER-336,Could you please add one to this patch?
ZOOKEEPER-336,Is it related to the fact that Hudson is currently reporting errors even without this patch?
ZOOKEEPER-337,Can you upload a new patch pat?
ZOOKEEPER-338,Updated as c client component - is this an issue for either the java server/client?
ZOOKEEPER-344,New state: Expired : zpath=/benchmark/jobs/com.bigdata.service.jini.benchmark.ThroughputMaster/test_1/client1356/locknode   can you post  corresponding session id's with these ?
ZOOKEEPER-344,You could also use JMX if that works for you: http://hadoop.apache.org/zookeeper/docs/current/zookeeperJMX.html What is the timeout value you are using for your ZK clients?
ZOOKEEPER-344,"Re your benchmark, how many operations/sec are you running?"
ZOOKEEPER-344,What's the read/write split?
ZOOKEEPER-344,"Your zk server is a single quad-core x86_64 cpu, correct?"
ZOOKEEPER-344,"Also, looking at your logs the client log is from 13:35 while the server log is from 13:06, assuming that the  clocks are even fairly close this is almost 30min difference, if true it's unlikely the events are correlated?"
ZOOKEEPER-344,"WARN [main-SendThread] org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:898) 2009-03-30 17:34:48,120 - Exception closing session 0x120597b6137000b to sun.nio.ch.SelectionKeyImpl@7eb1cc87 java.io.IOException: TIMED OUT         at org.apache.zookeeper.ClientCnxn$SendThread.run(ClientCnxn.java:837)  WARN [NIOServerCxn.Factory:2181] org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:417) 2009-03-30 17:34:48,166 - Exception causing close of session 0x120597b6137000b due to java.io.IOException: Read error DEBUG [NIOServerCxn.Factory:2181] org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:420) 2009-03-30 17:34:48,166 - IOException stack trace java.io.IOException: Read error         at org.apache.zookeeper.server.NIOServerCnxn.doIO(NIOServerCnxn.java:295)         at org.apache.zookeeper.server.NIOServerCnxn$Factory.run(NIOServerCnxn.java:162)  INFO [NIOServerCxn.Factory:2181] org.apache.zookeeper.server.NIOServerCnxn.close(NIOServerCnxn.java:752) 2009-03-30 17:34:48,172 - closing session:0x120597b6137000b NIOServerCnxn: java.nio.channels.SocketChannel[connected local=/192.168.6.21:2181 remote=/192.168.6.28:60720] And here is appears that the closed session was re-initialized?"
ZOOKEEPER-344,Perhaps closed != expired?
ZOOKEEPER-344,You are on a windows machine right?
ZOOKEEPER-344,and also its a single server ensemble?
ZOOKEEPER-344,hmm... Can you create a sample test application that I could run on my machine and see if I reproduce this on my linux machines?
ZOOKEEPER-344,How would I go about isolating that further outside of writing stress tests for zookeeper?
ZOOKEEPER-344,"If this is indeed a zookeeper bug and you have some idea of the possible issues involved, then perhaps you can suggest some additional instrumentation of zookeeper and I could run against a version with more instrumentation which might reveal something?"
ZOOKEEPER-345,"Thanks Henry, would it be possible for you to provide a patch for the C CLI as well?"
ZOOKEEPER-348,can you try using 3.1* versions?
ZOOKEEPER-353,"I think this is the case from looking at the patch but wanted to verify: javadoc target will only include javadoc on ""user public"" apis?"
ZOOKEEPER-353,"ie the limited subset of classes that we expose to users directly, the programming api etc... while javadoc-dev will include javadoc on all (public) apis?"
ZOOKEEPER-356,flavio is the zookeeper layout of bookkeeper documented somewhere?
ZOOKEEPER-356,"it shouldn't be much to fix:  in LedgerOutputStream why are you interrupting the thread on BKExceptions in the tests, why are you catching and just logging BKExceptions?"
ZOOKEEPER-356,shouldn't those make the tests fail?
ZOOKEEPER-356,i think down should be volatile in BookieServer why do you pass a BookieHandle to BookieClient in BookKeeper you should probably catch NumberFormatException when you call Long.parseLong its one of those things are are really hard to debug if it happens could you add a comment to the top of BookKeeper to explain how the different znodes are used?
ZOOKEEPER-356,it will really help the next person i think stop and incoming should be updated and read in the same synchronized block right?
ZOOKEEPER-356,in LedgerManager @return says getItem returns a long rather than String are next and errorCounter used in ClientCB?
ZOOKEEPER-356,"just a couple of things:  in BookieHandle, why doesn't stop get set to true on shutdown?"
ZOOKEEPER-356,you need to check all your uses of LOG.info most of them seem to really be LOG.debug in ClientCBWorker stop should be volatile in LedgerHandle shouldn't add/removeBookie be synchronized?
ZOOKEEPER-356,in QuorumEngine should idCounter be synchronized?
ZOOKEEPER-356,"[ Show » ] Benjamin Reed added a comment - 23/Jun/09 09:03 AM just a couple of things:  in BookieHandle, why doesn't stop get set to true on shutdown?"
ZOOKEEPER-356,you need to check all your uses of LOG.info most of them seem to really be LOG.debug in ClientCBWorker stop should be volatile in LedgerHandle shouldn't add/removeBookie be synchronized?
ZOOKEEPER-356,in QuorumEngine should idCounter be synchronized?
ZOOKEEPER-357,"ben, is this is an april fool's joke?"
ZOOKEEPER-357,Where can I get those hungry lions?
ZOOKEEPER-358,Any objection?
ZOOKEEPER-358,"also, specially in this case, since its a  api semantics change, also a test for this should nto be mroe than 2 lines of code?"
ZOOKEEPER-358,Is this a good idea?
ZOOKEEPER-358,"flavio,  was this patch included in ZOOKEEPER-383?"
ZOOKEEPER-360,Is this already covered by existing tests?
ZOOKEEPER-361,"i dont have access to vesta... can you grant me access, so that I can run the tests on the hudson machines?"
ZOOKEEPER-361,giri can you verify this works?
ZOOKEEPER-362,can you review the log calls to make sure that they should be info and error?
ZOOKEEPER-364,"however this is implemented as a proxy, rather than a core part of the server."
ZOOKEEPER-364,Perhaps C?
ZOOKEEPER-364,Perhaps Perl?
ZOOKEEPER-364,"Perhaps some other lang, like python?"
ZOOKEEPER-364,"So the benefits of exercising c, plus we get python binding, plus the benefits of implementing the commands using a scripting lang?"
ZOOKEEPER-366,anyone have an idea of how to test this?
ZOOKEEPER-366,Ben any progress on this?
ZOOKEEPER-366,Should we try to get it into 3.3.3?
ZOOKEEPER-366,Can we have some traction on this fix?
ZOOKEEPER-366,Can we have the patch updated for current release?
ZOOKEEPER-366,Any objections?
ZOOKEEPER-367,"Pat, can you verify that the patch works with the other logs as well that you uploaded?"
ZOOKEEPER-368,What do you think?
ZOOKEEPER-368,"What do people think about the need to break out Observer into its own class, and probably inherit from a base Peer set of classes where the code needs to be shared?"
ZOOKEEPER-368,"rather than adding the inform, why don't we just send the PROPOSE and COMMIT to the Observer as normal, and just make the Observer not send ACKs?"
ZOOKEEPER-368,Should it be a different jira or it is something we can consider for this patch?
ZOOKEEPER-368,did you have a case in mind?
ZOOKEEPER-368,right?
ZOOKEEPER-368,Is it right?
ZOOKEEPER-368,did you have a case in mind?
ZOOKEEPER-368,Why would a follower connect as an observer?
ZOOKEEPER-368,right?
ZOOKEEPER-368,"sorry to get in late here, I think I missed out on most of the discussions, I  will read through the comments before I comment on the approach, but just to clear things:  what is the practical use of Observers?"
ZOOKEEPER-368,What is the real motivation besides Paxos listeners for this?
ZOOKEEPER-368,Is there a valid real world scenario that we would solve or justify with this?
ZOOKEEPER-368,anything else?
ZOOKEEPER-368,"also, how does one configure a node to be an obersver?"
ZOOKEEPER-368,"what if someone does not use Observers, does the code behave the same way as it does now?"
ZOOKEEPER-368,WHat is the backwards compatibility story of this new featrue?
ZOOKEEPER-368,how do we test (probably use systests) for this new featrue?
ZOOKEEPER-368,Would the new servers be able to work with old 3.2 servers?
ZOOKEEPER-368,does that seem reasonable?
ZOOKEEPER-368,"Hi Flavio -  Have you downloaded the lastest patch (78kb, dated 13th July)?"
ZOOKEEPER-368, what is the practical use of Observers?
ZOOKEEPER-368,What is the real motivation besides Paxos listeners for this?
ZOOKEEPER-368,Is there a valid real world scenario that we would solve or justify with this?
ZOOKEEPER-368,anything else?
ZOOKEEPER-368,Do you still think we need more motivation?
ZOOKEEPER-368,Weird - you're applying the patch with patch -p0 < ZOOKEEPER-368.patch from zookeeper root dir?
ZOOKEEPER-368,Do you still think we need more motivation?
ZOOKEEPER-368,"I've only been following this a bit, but some questions around the plan wrt manageability: 1) adding removing observers, observer itself needs to be configured, any changes needed to config on existing ensemble?"
ZOOKEEPER-368,2) JMX - what's the plan?
ZOOKEEPER-368,what additional properties/actions will be supported?
ZOOKEEPER-368,3) 4letter words - same issues as jmx 4) debug-ability - ensure adequate logging (log4j) on ensemble as well as on obs itself 5) security - will an ensemble allow any observer to connect to it?
ZOOKEEPER-368,today we have ensemble participants hardwired into the config of each of the servers right?
ZOOKEEPER-368,"Perhaps a wiki ""proposal"" page should be created that will capture the ""current proposal"" for easy review?"
ZOOKEEPER-368,Comments?
ZOOKEEPER-368,Is it preparing for a forthcoming change?
ZOOKEEPER-368,How does that sound?
ZOOKEEPER-368,I have some higher leveel questions regarding obersvers currently connecting to leader  does an oberserver forward update request to the leader?
ZOOKEEPER-368,How is this handled?
ZOOKEEPER-368,"also, you guys mentioned that an observer should be able to connect for follower later sometime other than just the leader, do you have plans to do that?"
ZOOKEEPER-368,or have you thought about how you would do that and would that require any changes in the design/code changes you are submitting in this jira?
ZOOKEEPER-368,"also, just a cursory look at the patch shows that their is some duplicated code between follower and observers?"
ZOOKEEPER-368,Is that necessary?
ZOOKEEPER-368,Hi Mahadev -   An observer sends REQUEST packets to the Leader just like a Follower would (using the same code) - is this what you meant?
ZOOKEEPER-368,Should QuorumPeerConfig  just throw an exception and fail if peerType is specfied and it does not match either observer or participant?
ZOOKEEPER-368,what do you think?
ZOOKEEPER-368,"Do we want to separate out Observers into a separate class, and retain the Peer-> [Follower|Observer] hierarchy?"
ZOOKEEPER-368,How do we implement Observers - as members of a weight-0 quorum or with INFORM packets and some custom logic on the Leader side?
ZOOKEEPER-368,"hey i'm looking at the patch, can you comment on the VIEWCHANGE message?"
ZOOKEEPER-368,"Henry, could you sketch out your thoughts on how your modifications will handle ensemble changes?"
ZOOKEEPER-368,perhaps we could meet somewhere between here and SF for dinner?
ZOOKEEPER-368,Anyone had a chance to try this out yet?
ZOOKEEPER-368,Is this ok?
ZOOKEEPER-368,"Hey, Now that 3.2.1 has gone out, does it make sense to review this patch?"
ZOOKEEPER-368,Would you be able to upload a new patch for refactor and the other patch?
ZOOKEEPER-368,"Henry, are these throughput values for synchronous or asynchronous operations?"
ZOOKEEPER-368,Does this sound right?
ZOOKEEPER-368,Are there any gotchas about always running the responder thread?
ZOOKEEPER-368,Please bear with me for a little longer:  Could you please update the changes to the test files?
ZOOKEEPER-368,Due to a few recently committed patches they don't apply to trunk any longer; Could you make sure to remove all unnecessary LOG statements?
ZOOKEEPER-368,Is it correct?
ZOOKEEPER-368,Can I have observers with hierarchical quorums?
ZOOKEEPER-368,"Flavio, could you also review the comments on this JIRA as part of your commit review?"
ZOOKEEPER-368,for historical purposes do you have a copy of that summary that was produced of the differences in operation and motivation between zero-weight followers and observers?
ZOOKEEPER-368,Did you try some testing with current servers (killing one at a time and brining them up  in a round robin fashion) just to make sure it works all fine with the current servers (not including the patch)?
ZOOKEEPER-368,what happens if a server configured as follower is suddenly brought down and is made an observer and the other way around as well?
ZOOKEEPER-368,Is this reasonable?
ZOOKEEPER-368,"Should the built docs be included with diffs, or will that all shake out in Hudson?"
ZOOKEEPER-368,"henry,    did you get a chance to test observers with old (meaning without hte patch) zookeeper servers?"
ZOOKEEPER-368,Did you try some testing with current servers (killing one at a time and brining them up in a round robin fashion) just to make sure it works all fine with the current servers (not including the patch)?
ZOOKEEPER-368,what happens if a server configured as follower is suddenly brought down and is made an observer and the other way around as well?
ZOOKEEPER-368,"I don't want to make you generate another patch just to fix the majority check on that message, so if prefer not to do it, could you make sure there is a jira to fix it?"
ZOOKEEPER-368,Would you mind just commenting quickly?
ZOOKEEPER-368,Would you mind running those tests?
ZOOKEEPER-368,This should probably be considered user error?
ZOOKEEPER-373,"flavio,  can you comment on the jira, what specific changes you made?"
ZOOKEEPER-373,isn't it possible that two different threads going to two different ledgers use the same mac?
ZOOKEEPER-373,> isn't it possible that two different threads going to two different > ledgers use the same mac?
ZOOKEEPER-374,what version of gcc is this?
ZOOKEEPER-376,what will happen if I change Makefile.am and the old Makefile still exist?
ZOOKEEPER-376,Will it just run the old makefile or regenrate the Makefile again?
ZOOKEEPER-376,"Also, what happens if I change the configure.ac and the old Makefile still exists?"
ZOOKEEPER-378,So the dir structure would look like   src/contrib/zkperl/Changes src/contrib/zkperl/LICENSE src/contrib/zkperl/MANIFEST src/contrib/zkperl/Makefile.PL src/contrib/zkperl/build src/contrib/zkperl/t   comments?
ZOOKEEPER-378,"I'm fine with zkperl, but how about something like ""perl-client"" or ""zkperl-client""?"
ZOOKEEPER-378,"Also, does it matter that this is the perl binding on top of the C ZK client library, rather than a straight perl based implementation?"
ZOOKEEPER-378,Does this have a build.xml that can drive the tests from the toplevel build.xml?
ZOOKEEPER-378,From the console output it looks like a C++ test dumped core?
ZOOKEEPER-380,comments?
ZOOKEEPER-380,comments?
ZOOKEEPER-383,couldn't we?
ZOOKEEPER-383,What do you think?
ZOOKEEPER-383,Do we need that?
ZOOKEEPER-383,"In case someone needs to use the ledgerhandle or id in the callback he should be able to pass that via   the Object ctx, no?"
ZOOKEEPER-386,Is it worth adding a library dependency to the CLI for this feature?
ZOOKEEPER-386,We're also looking at adding command line support (perhaps through python?
ZOOKEEPER-386,"see ZOOKEEPER-364 ), maybe it makes sense to have ""user tool"" shell in python instead... Basically how many/which shells do we want?"
ZOOKEEPER-386,thoughts?
ZOOKEEPER-386,should we split this jira to address just hte java shell ?
ZOOKEEPER-386,Could you use SVN to re-create the patch?
ZOOKEEPER-386,"ie ""svn diff"" and resubmit?"
ZOOKEEPER-386,"we can support a shell that uses jline if the jar is available, however drops back to non-jline if the jar is not available?"
ZOOKEEPER-386,Regarding your other points:  zkCli.sh - doesn't zkEnv.sh make sure that all jars in $ZOOLIBDIR (which is bin/../lib on my machine) get added to the classpath?
ZOOKEEPER-386,What's the best way to make that happen for a release?
ZOOKEEPER-386,What's the right way to get Hudson to pick up the jar and resume progress on this issue?
ZOOKEEPER-387,WOuld you be able to aadd  the test to ZOOKEEPER-380?
ZOOKEEPER-389,Perhaps you could commit this and add a new JIRA for 4.0 to address this?
ZOOKEEPER-393,Does the streaming interface that Mahadev added (ZOOKEEPER-380) solve your problem?
ZOOKEEPER-395,don't delete the old patch (in general) 3) why not consider zk.py your smoketest/test?
ZOOKEEPER-395,"henry,  are you going to add tests to this patch?"
ZOOKEEPER-395,Any ideas?
ZOOKEEPER-395,would that work?
ZOOKEEPER-395,"also, is their any requirements for python versions?"
ZOOKEEPER-395,Do I need to install some version greater than 2.3?
ZOOKEEPER-395,or some other python module?
ZOOKEEPER-395,"However we will be putting an OO wrapper anyway, right?"
ZOOKEEPER-395,So perhaps renaming isn't such a big deal...?
ZOOKEEPER-395,"I tried running zk.py against a local zk server and this is what I got   onnecting to localhost:2181 -- Connected, handle is  0 Creating sequence node  0   0 Creating sequence node  1   0 Creating sequence node  2   0 Creating sequence node  3   0 Creating sequence node  4   0 ZNode tree -- |---/ ::         |---/zk-python :: data                 |---/zk-python/sequencenode0000000003 :: data                 |---/zk-python/sequencenode0000000004 :: data                 |---/zk-python/sequencenode0000000001 :: data                 |---/zk-python/sequencenode0000000002 :: data                 |---/zk-python/sequencenode0000000000 :: data Segmentation fault   is zk.py working for you henry?"
ZOOKEEPER-395,Is this a clean server?
ZOOKEEPER-395,"Running against the latest module version (0.3), using python 2.3?"
ZOOKEEPER-395,Can you add a chmod task to the build.xml?
ZOOKEEPER-395,"Something like the following:  <target name=""chmod-shell-scripts"">   <chmod perm=""ugo+x"" file=""path/to/zkServer.sh"" />   <chmod perm=""ugo+x"" file=""path/to/run_tests.sh"" /> </target>   and then make the test target depend on it?"
ZOOKEEPER-395,"Still, I'd like to know why it crashed - do you still have the snapshot lying around?"
ZOOKEEPER-395,are there any issues that must be addressed before commit?
ZOOKEEPER-402,"The specific changes look good, however I think we should include the following: 1) I don't see this documented in zookeeper.h api docs, please update the api docs for create/set/get 2) the tests should test all methods - set for example is not tested What methods are impacted?"
ZOOKEEPER-402,"create/get/set, that's it?"
ZOOKEEPER-402,"Do the async versions of the methods also need to be tested, or is that covered by the sync?"
ZOOKEEPER-403,Flavio can you look at the remaining warning?
ZOOKEEPER-403,shouldnt it be -Xlint:path or does -Xlint:-path also work?
ZOOKEEPER-403,Did you add that for the generated files warnings?
ZOOKEEPER-408,"Still some issues in datanode/datatree, Mahadev you are more familiar with this code, can you address?"
ZOOKEEPER-408,"Also, should we change upgrade code or just ignore it?"
ZOOKEEPER-408,Seems like ignore would be good as this is legacy code... thoughts?
ZOOKEEPER-408,"when i removed the final, ClientTest hangs"
ZOOKEEPER-410,Can you take another look?
ZOOKEEPER-411,Can you fix this in all locations in the source?
ZOOKEEPER-411,this patch removes the use of fuser from all the scripts also from the build file... pat can you review this?
ZOOKEEPER-412,Can this issue be closed?
ZOOKEEPER-412,Any thoughts?
ZOOKEEPER-412,Mind changing the basicOffset and resubmitting?
ZOOKEEPER-412,"Flavio Paiva Junqueira, Chris Nauroth: could you take one more look?"
ZOOKEEPER-412,"I see this was taken from the existing code, but could you take the opportunity to change it to something like ""Run Checkstyle coding standard checks""?"
ZOOKEEPER-412,Would you please switch to spaces?
ZOOKEEPER-412,Do you think it makes sense to use a wildcard to put all of ivy.test.lib on the classpath?
ZOOKEEPER-412,Would this be more resilient to change if the dependencies ever change in the future?
ZOOKEEPER-414,"I'm guessing that it wouldn't be helpful to have ""zkServer.sh delete""?"
ZOOKEEPER-417,can you update the jira with the patch that applies to trunk?
ZOOKEEPER-417,should i put the integer in the new error code rather than added a new deprecated constant?
ZOOKEEPER-417,what am i missing?
ZOOKEEPER-417,the patch looks good ... i have some comments –  line 543  in NIOServerCnxn.java   si.setOwner(zk); zk.submitRequest(si);   Can we just use some static final Object adn si.setOwner(Object)?
ZOOKEEPER-417,Is there any use of using zk specifically?
ZOOKEEPER-417,what do you think?
ZOOKEEPER-418,Anyone willing to create a patch and some minimal docs (README.txt) for this?
ZOOKEEPER-419,codepath?
ZOOKEEPER-419,Perhaps add a JIRA that documents we need to verify refcnt at some point?
ZOOKEEPER-419,Is there some facility/extn/addon for python that supports test/verification of refcnt correctness?
ZOOKEEPER-419,codepath?
ZOOKEEPER-420,It seems like this is probably related to ZOOKEEPER-316 as well?
ZOOKEEPER-420,"[exec] Running src/test/clientid_test.py [exec] Traceback (most recent call last): [exec]   File ""src/test/clientid_test.py"", line 21, in ?"
ZOOKEEPER-420,"[exec]     import zookeeper, zktestbase [exec] ImportError: No module named zookeeper [exec] Running src/test/connection_test.py [exec] Traceback (most recent call last): [exec]   File ""src/test/connection_test.py"", line 21, in ?"
ZOOKEEPER-420,"[exec]     import zookeeper, zktestbase [exec] ImportError: No module named zookeeper [exec] Running src/test/create_test.py [exec] Traceback (most recent call last): [exec]   File ""src/test/create_test.py"", line 19, in ?"
ZOOKEEPER-420,"[exec]     import zookeeper, zktestbase, unittest, threading [exec] ImportError: No module named zookeeper [exec] Running src/test/delete_test.py [exec] Traceback (most recent call last): [exec]   File ""src/test/delete_test.py"", line 19, in ?"
ZOOKEEPER-420,"[exec]     import zookeeper, zktestbase, unittest, threading [exec] ImportError: No module named zookeeper [exec] Running src/test/exists_test.py [exec] Traceback (most recent call last): [exec]   File ""src/test/exists_test.py"", line 19, in ?"
ZOOKEEPER-420,"[exec]     import zookeeper, zktestbase, unittest, threading [exec] ImportError: No module named zookeeper [exec] Running src/test/get_set_test.py [exec] Traceback (most recent call last): [exec]   File ""src/test/get_set_test.py"", line 19, in ?"
ZOOKEEPER-420,Any suggestions?
ZOOKEEPER-420,For the last problem - could you add this line to run_tests.sh after the PYTHONPATH is set?
ZOOKEEPER-420,Do you see the PYTHONPATH directory in the list you get?
ZOOKEEPER-420,"also, I still think ant test should be dependent on compile.no?"
ZOOKEEPER-423,"Take a look at ZOOKEEPER-282 - perhaps should wrap this all up together with List<String> listChildren(start, count, order, watch/watcher) type of api (async too) tricky bit is probably the semantics of watch?"
ZOOKEEPER-423,also how to keep track of the znodes btw calls?
ZOOKEEPER-423,It seems like watchers can have much the same semantics as for getChildren?
ZOOKEEPER-423,when that happens some of these options would be hard/very expensive/blocking.
ZOOKEEPER-423,"when the creation happens, we can store the xid with the child's name in the parent data structure since it doesn't change, so CREATED is reasonable."
ZOOKEEPER-423,Does anyone have any thoughts?
ZOOKEEPER-423,Any comments on the APIs would be great - would we rather one getOrderedChild API which took a flag describing whether to get the first or last?
ZOOKEEPER-423,Or a getNthChild API?
ZOOKEEPER-423,allow an ordered access to the child nodes)?
ZOOKEEPER-423,"Could you describe the use case you're thinking of, so we can properly weigh up the idea?"
ZOOKEEPER-423,Is that what you're describing?
ZOOKEEPER-425,Did you actually take a look at the attached MANIFEST.MF?
ZOOKEEPER-425,Are the import and export statements in there correct?
ZOOKEEPER-425,A dumb q: adding this to the manifest of the zk jar will have no effect on non-osgi containers (etc...) correct?
ZOOKEEPER-425,"so i still have the same concern with the full manifest.mf, but before that i was wondering: are you trying to provide the bundle so that other bundles can use zookeeper or so that the bundle can start up a zookeeper server?"
ZOOKEEPER-425,is there already a standard log4j bundle?
ZOOKEEPER-425,Would that be the best idea?
ZOOKEEPER-425,Would it be a good idea to publish a management interface to the service registry when Zookeeper is started by the ManagedService?
ZOOKEEPER-425,"1) would go into build.xml 2) & 3) would be in a contrib package, correct?"
ZOOKEEPER-425,src/contrib/osgi – or is this stuff typically implementation specific such as src/contrib/felix ?
ZOOKEEPER-425,"On part 2 - this is the one that Alan filed ZOOKEEPER-584 for, right?"
ZOOKEEPER-425,"Could we not do the improvement over time in the future, starting off with something that works a bit like in my patch and then making it better over time?"
ZOOKEEPER-425,Do you mean just putting the source code in a separate location or are you also thinking of putting it in a separate jar file?
ZOOKEEPER-425,"Just curious, no ""uses"" clauses?"
ZOOKEEPER-425,Does the zookeeper infrastructure have such an area?
ZOOKEEPER-425,Is there such a phase in the zookeeper build system?
ZOOKEEPER-425,Why not use PAX Exam?
ZOOKEEPER-425,Just to summarize - what's being applied here (patch)?
ZOOKEEPER-425,"Is there a way to load this into something like Apache Felix yet, or does that have to wait for the follow-on jira?"
ZOOKEEPER-426,the plan is to put all of these files in bin and svn add them correct?
ZOOKEEPER-427,"satish, can you just try strace to see which one of thread is spinning?"
ZOOKEEPER-427,"also, with the log files it seems like you are doing a lot of trasactions through some other zookeeper server?"
ZOOKEEPER-432,Do we realyl need that?
ZOOKEEPER-432,A committer can just set the files that you want to be executable while commiting... no?
ZOOKEEPER-432,"also, just checking to confirm that the patch does not implement the other zoo_w* apis with local watches and context objects right?"
ZOOKEEPER-432,So does the python api allow you do pass a ctx object with a local watcherfn?
ZOOKEEPER-436,Could you please re-generate the patch having the zookeeper project folder as the root?
ZOOKEEPER-438,Ben can you take a look at this?
ZOOKEEPER-442,etc... what are we removing?
ZOOKEEPER-442,the trigger or both the trigger and notification(s)?
ZOOKEEPER-442,"what if one client has been notified but not  others (say two clients watch a node N, c1 is on a fast server and gets notified, c2 removes the watch on a slow server before the trigger fires, ...) etc... it would be great if someone was willing to document a proposal(s) and post it on this jira for review/comment."
ZOOKEEPER-442,What are we removing?
ZOOKEEPER-442,The trigger or both?
ZOOKEEPER-442,"Perhaps removal of the watch should itself trigger the notification to all watchers, with a new notification type of ""watch removed""?"
ZOOKEEPER-442,So maybe it's better not to offer a feature that might be misunderstood?
ZOOKEEPER-442,Any ideas?
ZOOKEEPER-442,Are we still interested on this feature after ZOOKEEPER-1177 gets integrated?
ZOOKEEPER-442,"Any leak must be fixed While ZOOKEEPER-1177 fixes server-side, it does not help client-side, is it?"
ZOOKEEPER-442,How should we deal with the asynchronous version of the call?
ZOOKEEPER-442,"Vitalii, I don't understand why would we need to keep track of the watcher group's state (normal/deleting/creating), could you explain?"
ZOOKEEPER-442,"You must sent add watch request, but how do you know it?"
ZOOKEEPER-442,What do you think?
ZOOKEEPER-442,"@Ben,  Can you please take a look at this patch?"
ZOOKEEPER-442,can you put it on reviews.apache.org?
ZOOKEEPER-442,src/java/main/org/apache/zookeeper/ZooKeeper.java <https://reviews.apache.org/r/3364/#comment9414>     Maybe collapse this to if(watchers != null && watchers.contains(watcher)) ?
ZOOKEEPER-442,"Can we have instead two methods, one for removing all watchers and one for just removing a watch if it exists?"
ZOOKEEPER-442,src/java/main/org/apache/zookeeper/ZooKeeper.java <https://reviews.apache.org/r/3364/#comment9416>     ??
ZOOKEEPER-442,"src/java/main/org/apache/zookeeper/ZooKeeper.java <https://reviews.apache.org/r/3364/#comment9426>     all watchers registered by this session, correct?"
ZOOKEEPER-442,"src/java/main/org/apache/zookeeper/ZooKeeper.java <https://reviews.apache.org/r/3364/#comment9427>     this is confusing, what does ""leak"" mean?"
ZOOKEEPER-442,src/java/main/org/apache/zookeeper/ZooKeeper.java <https://reviews.apache.org/r/3364/#comment9428>     @throws?
ZOOKEEPER-442,src/java/main/org/apache/zookeeper/ZooKeeper.java <https://reviews.apache.org/r/3364/#comment9425>     Update all the @since with expected release - looks like 3.5.0 src/java/main/org/apache/zookeeper/ZooKeeper.java <https://reviews.apache.org/r/3364/#comment9429>     why type vs having explicit methods?
ZOOKEEPER-442,"On second thought though, shouldn't we have a ""both"" (or ""alltypes"", etc...) option as well?"
ZOOKEEPER-442,"To reply, visit: https://reviews.apache.org/r/3364/#review4186 ----------------------------------------------------------- src/java/main/org/apache/zookeeper/ZooKeeper.java <https://reviews.apache.org/r/3364/#comment9433>     is it needed?"
ZOOKEEPER-442,Shall we revisit this?
ZOOKEEPER-442,"Rakesh Radhakrishnan just to make sure I'm understanding correctly, the document you put together is based on the current approach/patch, is that right?"
ZOOKEEPER-442,Or are you suggesting a different implementation?
ZOOKEEPER-442,"The offending javadoc warning in the latest patch:  [exec] [javadoc] /home/jenkins/jenkins-slave/workspace/PreCommit-ZOOKEEPER-Build/trunk/src/java/main/org/apache/zookeeper/ZooKeeper.java:2326: warning - Tag @see: can't find removeWatches(String, Watcher, WatcherType, boolean) in org.apache.zookeeper.ZooKeeper The offending line seem to be this: @see #removeWatches(String, Watcher, WatcherType, boolean) Just a guess: wouldn't it be @see  {@link #removeWatches(String, Watcher, WatcherType, boolean)}  ?"
ZOOKEEPER-442,Anyone?
ZOOKEEPER-442,"In:  +        private boolean removeWatches(Map<String, Set<Watcher>> watches, +                Watcher watcher, String path, boolean local, int rc, +                Set<Watcher> removedWatchers) { +            // Check whether watches list contains the given watcher +            boolean containsWatcher = contains(path, watcher, watches); +            if (!containsWatcher) { +                // Watcher not found for the given params +                return false; +            } + +            // Couldn't remove locally as it doesn't sees a success from server +            if (!local && watcher == null && rc != Code.OK.intValue()) { +                return containsWatcher;   shouldn't it return false since it couldn't remove in the server?"
ZOOKEEPER-442,The next part looks wrong too:  +            } else if (!local && rc != Code.OK.intValue()) { +                Set<Watcher> watchers = watches.get(path); +                // Couldn't remove locally as it doesn't sees a success from +                // server +                if (watchers.size() == 1) { +                    return containsWatcher; +                } else if (watchers.remove(watcher)) { +                    // found path watcher +                    removedWatchers.add(watcher); +                    return containsWatcher; +                }   why would watchers.size() == 1 imply that it was that the watches were removed?
ZOOKEEPER-442,"Also, would it make since if they API also allowed to remove all watchers for a given path?"
ZOOKEEPER-442,"In src/java/main/org/apache/zookeeper/ZooKeeper.java:  +        public Map<EventType, Set<Watcher>> removeWatcher(String clientPath, +                Watcher watcher, WatcherType watcherType, boolean local, int rc) +                throws KeeperException { .... +            removedWatchers +                    .put(EventType.ChildWatchRemoved, childWatchersToRem); .... +            case Any: { +                removedWatchers.put(EventType.ChildWatchRemoved, +                        childWatchersToRem);   The call to removedWatchers.put(EventType.ChildWatchRemoved, childWatchersToRem) inside the Any switch clause doesn't seem to be needed, no?"
ZOOKEEPER-442,"Nit in:  +    public void removeWatches(String path, Watcher watcher, +            WatcherType watcherType, boolean local) +            throws InterruptedException, KeeperException { +        final String clientPath = path;   why is assigning to clientPath needed?"
ZOOKEEPER-442,"In the previous comments the path param is referred as clientPath anyway, maybe renamed it?"
ZOOKEEPER-442,""", nwe); +            cb.processResult(nwe.code().intValue(), clientPath, ctx); +            return; +        }   I think we should just throw NoWatcherException otherwise how can the caller of this (async) method know if it failed to be scheduled?"
ZOOKEEPER-442,I think we should just throw NoWatcherException otherwise how can the caller of this (async) method know if it failed to be scheduled?
ZOOKEEPER-442,"If you agree with my point, I'll leave this part alone and fix other comments ?"
ZOOKEEPER-442,"Ah, good catch Camille Fournier - mind filing a bug for that?"
ZOOKEEPER-442,:  https://github.com/apache/zookeeper/blob/trunk/src/c/src/zookeeper.c#L3063 I guess it is also true that this is the first async method that actually does some real client side validation before issuing the call?
ZOOKEEPER-442,Based on the most recent comments are there any other changes pending?
ZOOKEEPER-442,Or should we consider this ready?
ZOOKEEPER-442,why is assigning to clientPath needed?
ZOOKEEPER-442,"In the previous comments the path param is referred as clientPath anyway, maybe renamed it?"
ZOOKEEPER-442,"(note you need to install the 3.5.0-SNAPSHOT artifacts in your local maven cache, you can do this by running ""ant package"" in ZK and copying the resulting artifacts from the build subdir dist-maven directory into your .m2 repository) Does my code make sense?"
ZOOKEEPER-442,"I suspect the issue is that we are setting up some data structures to hold the watch information, but not fully clearing that data when removing the watch any ideas?"
ZOOKEEPER-442,Can you both (Rakesh/Raul) also code review the synchronization around that code?
ZOOKEEPER-442,Are you agreeing to keep operation timeout as CONNECTION_TIMEOUT/5 milliseconds?
ZOOKEEPER-442,Are you agreeing to keep operation timeout as CONNECTION_TIMEOUT/5 milliseconds?
ZOOKEEPER-442,"Given you are using TIME_OUT in this way, perhaps you should use a lower value?"
ZOOKEEPER-443,should we be using that?
ZOOKEEPER-443,"also   -                ZooTrace.logRequest(LOG, traceMask, 'P', request, """"); +                if (LOG.isTraceEnabled()) { +                    ZooTrace.logRequest(LOG, traceMask, 'P', request, """"); +                }   doesn't really need the if does it?"
ZOOKEEPER-445,Is this a bug?
ZOOKEEPER-451,"Why not something like ""enforceQuotaLimit""?"
ZOOKEEPER-451,"PS: you should indicate the parts changed in the JIRA, so besides the server, there was the c and Java client, right?"
ZOOKEEPER-451,Are you willing to create a pull request on GitHub?
ZOOKEEPER-457,Is this something critical for 3.2.0 or can it wait for 3.2.1/3.3.0?
ZOOKEEPER-458,"+1 the patch looks good ... steven, would it be possible to add tests to it?"
ZOOKEEPER-458,Any tips on the best way to do this?
ZOOKEEPER-458,is it passing for you?
ZOOKEEPER-458,Now I'm wondering how the old patch passed?
ZOOKEEPER-458,you can take a look at  http://hudson.zones.apache.org/hudson/job/Zookeeper-Patch-h8.grid.sp2.yahoo.net/76/console are the cppunit tests passing for you?
ZOOKEEPER-458,"Can't tell where it segfaults, it should have connected to the server if the zoo_exists returns ZOK?"
ZOOKEEPER-458,This is the stack trace from the core dump:  #0  0x00002b101d67f6e3 in ??
ZOOKEEPER-458,() from /lib/libc.so.6 #1  0x00002b101d680e98 in ??
ZOOKEEPER-458,"Steven,  can you take a look and see if you find something obvious?"
ZOOKEEPER-458,Have you tried running with valgrind?
ZOOKEEPER-458,Did you get a chacne to take a look at it?
ZOOKEEPER-458,did you find something?
ZOOKEEPER-458,"What do we want to do here guys, push to 3.4.0?"
ZOOKEEPER-459,Do you mean that you get no exception when you try to read from the ledger?
ZOOKEEPER-460,"the build has been failing for the past 6 days, this is very bad – in effect no CI Henry, can you look at this or should I?"
ZOOKEEPER-460,"This test runs fine for me locally, so is the problem a heavily loaded Hudson, causing the connection loss?"
ZOOKEEPER-460,Does that sound right?
ZOOKEEPER-460,however 473 is separate from this issue.
ZOOKEEPER-460,Are you sure you have Clover in the runtime classpath?
ZOOKEEPER-462,"Flavio, what do you want this in?"
ZOOKEEPER-462,3.3 or does it have to go into the fix release as well?
ZOOKEEPER-462,What's the status on this?
ZOOKEEPER-464,A few high-level comments:  Could you summarize the changes of this patch?
ZOOKEEPER-464,That's why your patch got a -1 in release audits; Could you detail the issue with BufferedChannel?
ZOOKEEPER-464,Where is the problem exactly?
ZOOKEEPER-464,Why can't we fix it?
ZOOKEEPER-464,Where should I put the summary of the behavior?
ZOOKEEPER-464,What about documentation of this feature?
ZOOKEEPER-464,Should I put that in comments for this Jira?
ZOOKEEPER-464,Should I upload a text documentation too to describe the feature functionality?
ZOOKEEPER-464,"assertTrue(false); }   with:  assertFalse(f.isFile() && f.getName().equals(""0.log""), ""Found the entry log file (0.log) that should have been deleted in ledgerDirectory: "" + ledgerDirectory);   I believe it is more compact and does the same, doesn't it?"
ZOOKEEPER-464,Could you let me know which files still have the comments preceding new methods?
ZOOKEEPER-464,"With regards to the documentation changes, do you generally modify the xml content document files, use forest to generate the html and pdf files and then check in all 3 changes in the jira attachment?"
ZOOKEEPER-464,Or is it just the xml changes you submit via the jira?
ZOOKEEPER-464,Can I submit another file attachment to this same jira for the documentation changes?
ZOOKEEPER-464,Can you merge the changes there with the code changes in the already submitted patch?
ZOOKEEPER-464,Could you please tell me how you've fixed the issue with the unit test?
ZOOKEEPER-464,Could you please break up the lines?
ZOOKEEPER-465,"Please pardon my ignorance, but your approach works because nobody can append new entries to a ledger after it is closed, right?"
ZOOKEEPER-465,"Also, what will be the semantics of a concurrent reader?"
ZOOKEEPER-465,"For example, if process A is writing to a ledger while at the same time another process B wants to find the length of the ledger, Is this possible?"
ZOOKEEPER-465,> My current idea is to simply have the writer counting the number of bytes written and store it to ZooKeeper Does this mean that every addEntry call to the ledger will result in an additional zk call to update the ledger length?
ZOOKEEPER-465,Any other option I'm missing?
ZOOKEEPER-465,Maybe a brain-dead idea: but can we write the current size of the ledger along with each entry in the ledger?
ZOOKEEPER-465,Is this a big change flavio?
ZOOKEEPER-465,> can we write the current size of the ledger along with each entry in the ledger?
ZOOKEEPER-465,am i understanding it right?
ZOOKEEPER-465,Do you have a use case for multiple clients writing to the same ledger?
ZOOKEEPER-465,Then we are still good with the approach where the client can maintain the current ledger size?
ZOOKEEPER-465,Just a hypothetical question: does Bookkeeper make any assumptions that there is only one writer to a ledger?
ZOOKEEPER-465,"if so, then what happens if a second client starts writing to the same ledger, will it get an error?"
ZOOKEEPER-465,"If it is not too much work for you, can you pl upload this patch in reviewboard, just makes it easier to review?"
ZOOKEEPER-465,"sorry to be a pain flavio, but can i get a couple very minor changes?"
ZOOKEEPER-465,"1) in PendingReadOp can you comment what you substract 8 on the line:  +        entry.length = buffer.getLong(DigestManager.METADATA_LENGTH - 8);   2) in LedgerRecoveryOp can you comment on the line:  +            lh.length = entry.getLength() - (long) data.length;   i think it is because you are going to call add entry on that data, so it will be added back, right?"
ZOOKEEPER-465,"btw, dhruba, is this what you were looking for?"
ZOOKEEPER-465,How does a system know to ignore the data from bookie 5?
ZOOKEEPER-465,Do you have a patch for that?
ZOOKEEPER-465,what do you think?
ZOOKEEPER-465,"I might have to start using trunk because ZOOKEEPER-712 is essential to store hdfs logs in bookkeeper, isn't it?"
ZOOKEEPER-465,Especially to recover from a scenario when the namenode died/killed/crashed before closing the ledger?
ZOOKEEPER-465,has anyone tried applying ZOOKEEPER-712 to 3.3?
ZOOKEEPER-465,Could anyone please review/commit?
ZOOKEEPER-465,"flavio, can you please upload a patch for 3.3 branch?"
ZOOKEEPER-467,I mean to say that this patch does not require tests (why can't we edit comments any longer?
ZOOKEEPER-472,I htought the jira was just about not instantiating hashmap.. no?
ZOOKEEPER-472,Why does PersistentNode and Ephemeral node need to be different?
ZOOKEEPER-472,"They can be the same but with the property that until and unless a addchild is done, the hashset maps to null... wouldnt that be sufficient?"
ZOOKEEPER-472,Even with the above you wont be able to do sorted nodes since the chidlren are still sets... no?
ZOOKEEPER-472,The children member should map to some other datastructure that maintains order.. no?
ZOOKEEPER-472,Is that a miss in the docs or is that what is really being used?
ZOOKEEPER-472,"Hi, what's the status on this JIRA?"
ZOOKEEPER-472,"@ Patrik , well good thing you cannot take me in the ear and sit me down  Might want to change the instructions on http://wiki.apache.org/hadoop/ZooKeeper/HowToContribute though, to not make people confused?"
ZOOKEEPER-472,Perhaps it's against an older version of zk source?
ZOOKEEPER-472,Would you mind creating a patch against the current source HEAD in svn?
ZOOKEEPER-472,Is there something you changed in the licence?
ZOOKEEPER-472,"erik, there are apache header changes in 2 files, any reason for that?"
ZOOKEEPER-472,Is this ready?
ZOOKEEPER-472,"Since I'm not adding any new functionality, the old tests should be enough, or what is the general opinion on this matter?"
ZOOKEEPER-473,what do you think?
ZOOKEEPER-473,"also, another check does @Test tags work with javac 1.5?"
ZOOKEEPER-474,"chris,  any update on this?"
ZOOKEEPER-475,"flavio, can you take a look at it?"
ZOOKEEPER-475,"the nightly build failed again last night, this time due to a failure in HierarchicalQuorumTest Flavio can you take a look?"
ZOOKEEPER-480,do you mind putting a comment into the test to state your strategy for posterity?
ZOOKEEPER-480,can you please update the patch?
ZOOKEEPER-480,"flavio, canm you upload 3.2 patch as well?"
ZOOKEEPER-481,Does this change have any impact on ZOOKEEPER-22?
ZOOKEEPER-481,do you mind putting a comment into the test to state your strategy for posterity?
ZOOKEEPER-481,Can you please try running findbugs and see where the issues are?
ZOOKEEPER-483,"ryan,  can you post (attach as files) server logs in different files for all you zookeeper servers?"
ZOOKEEPER-483,"also, please explain the setup –  I am assuming all the servers are on different machines, and the logs and snapshots go to different disk?"
ZOOKEEPER-483,Are you sure you are using 3.1.1?
ZOOKEEPER-483,"This is interesting, from hbase-hadoop-zookeeper-sv2borg153.log 2009-07-23 12:29:01,661 INFO org.apache.zookeeper.server.quorum.Follower: shutdown called java.lang.Exception: shutdown Follower 	at org.apache.zookeeper.server.quorum.Follower.shutdown(Follower.java:427) 	at org.apache.zookeeper.server.quorum.QuorumPeer.run(QuorumPeer.java:498) I don't see any further quorum messages until ~11 seconds later: 2009-07-23 12:29:12,516 FATAL org.apache.zookeeper.server.SyncRequestProcessor: Severe unrecoverable error, exiting java.net.SocketException: Socket closed 	at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:99) 	at java.net.SocketOutputStream.write(SocketOutputStream.java:136) 	at java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:65) 	at java.io.BufferedOutputStream.flush(BufferedOutputStream.java:123) 	at org.apache.zookeeper.server.quorum.Follower.writePacket(Follower.java:100) 	at org.apache.zookeeper.server.quorum.SendAckRequestProcessor.flush(SendAckRequestProcessor.java:52) 	at org.apache.zookeeper.server.SyncRequestProcessor.flush(SyncRequestProcessor.java:131) 	at org.apache.zookeeper.server.SyncRequestProcessor.run(SyncRequestProcessor.java:76) 2009-07-23 12:29:12,559 WARN org.apache.zookeeper.server.NIOServerCnxn: Exception causing close of session 0x0 due to java.io.IOException: ZooKeeperServer not running SRP should be running/active if the QP is not following the leader?"
ZOOKEEPER-483,Perhaps it's ok in this situation?
ZOOKEEPER-483,You sure we should be eating the exception here?
ZOOKEEPER-483,rather than handling upstream?
ZOOKEEPER-483,Should this be handled by higher level code?
ZOOKEEPER-483,the test added with the patch failed on hudson.. ben can you take a look?
ZOOKEEPER-483,"ben,  should me make the calss positioninputstream a seperate public class under persistence?"
ZOOKEEPER-485,Do you have anything we could use as an example of how to run ZK under SMF?
ZOOKEEPER-492,Is this supposed to happen?
ZOOKEEPER-494,"Users will have to change either there code or makefiles to adapt to this new change, right?"
ZOOKEEPER-494,"right, so then we should wait for 4.0 for this patch ?"
ZOOKEEPER-496,"this is minor, but could you also change the tabs to 4 spaces?"
ZOOKEEPER-496,what will happen in the values are binary?
ZOOKEEPER-498,"flavio, can you include the example in the forrest docs?"
ZOOKEEPER-498,"BTW - Should I succeed in convincing my company to allow me to open  source various components that I've written (on top of zookeeper), what  is the process for that?"
ZOOKEEPER-498,"flavio, can you upload a patch for 3.2 as well?"
ZOOKEEPER-498,"when setting the stop flags, you should really do an interrupt to wake up the wait, but that will cause a message to be printed to stdout."
ZOOKEEPER-499,"this looks good pat, but when you first get the logger, why are you using the package name?"
ZOOKEEPER-499,if you are going to use the package name shouldn't you get the package from the class file?
ZOOKEEPER-499,couldn't that cause a problem potentially?